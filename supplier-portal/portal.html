<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WeDealize - Supplier Portal</title>
    <link rel="icon" type="image/png" href="./favicon.png">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="design-system.css">
    <link rel="stylesheet" href="components.css">
    <!-- Cropper.js for image cropping -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.css">
    <!-- Google Sign-In -->
    <script src="https://accounts.google.com/gsi/client" async defer>
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.js"></script>
    <!-- PDF.js for catalog extraction -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>if(window.pdfjsLib){pdfjsLib.GlobalWorkerOptions.workerSrc='https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';}</script>
    <script>
        // Prevent auth/dashboard flash: inject guard style before first paint
        // JS removes this style tag when it takes over control
        (function() {
            var loggedIn = false;
            try {
                if (localStorage.getItem('supplier_logged_in') === 'true') {
                    var t = localStorage.getItem('supplier_token');
                    if (t) {
                        var p = JSON.parse(atob(t.split('.')[1]));
                        if (!p.exp || p.exp * 1000 > Date.now()) {
                            loggedIn = true;
                        }
                    }
                }
            } catch(e) {}
            var s = document.createElement('style');
            s.id = 'flash-guard';
            s.textContent = loggedIn
                ? '#auth-section{display:none!important}'
                : '#dashboard-section{display:none!important}';
            document.head.appendChild(s);
        })();
    </script>
</head>
<body>
    <div class="portal-app">
        <!-- Header -->
        <header class="portal-header">
            <div class="header-content">
                <div class="logo">
                    <img src="logo.png" alt="WeDealize" height="32">
                </div>
                <nav class="header-nav">
                    <!-- Language Selector Dropdown -->
                    <div class="language-dropdown" id="language-dropdown">
                        <button class="language-btn" id="language-btn" onclick="toggleLanguageDropdown()">
                            ðŸ‡ºðŸ‡¸ English <span class="dropdown-arrow">â–¼</span>
                        </button>
                        <div class="language-menu" id="language-menu">
                            <div class="language-search">
                                <input type="text" id="language-search" placeholder="Search language..." oninput="filterLanguages(this.value)">
                            </div>
                            <div class="language-list" id="language-list">
                                <!-- Languages will be populated by JS -->
                            </div>
                        </div>
                    </div>
                    <div class="user-menu" id="user-menu" style="display: none;">
                        <span class="user-name" id="user-name"></span>
                        <button class="btn-logout" onclick="logout()" data-i18n="header.logout">Logout</button>
                    </div>
                </nav>
            </div>
        </header>

        <!-- Main Content -->
        <main class="portal-main">
            <!-- Login/Register Section (Initial Screen) -->
            <section class="wd-auth-section" id="auth-section">
                <div class="wd-auth-card">
                    <div class="wd-auth-tabs">
                        <button class="wd-auth-tab active" data-tab="login" data-i18n="auth.login">Login</button>
                        <button class="wd-auth-tab" data-tab="register" data-i18n="auth.register">Register</button>
                    </div>

                    <!-- Login Form -->
                    <form class="wd-auth-form active" id="login-form" onsubmit="handleLogin(event)">
                        <h2 class="wd-auth-title" data-i18n="auth.welcomeBack">Welcome Back</h2>
                        <p class="wd-auth-subtitle" data-i18n="auth.accessDashboard">Access your supplier dashboard</p>

                        <!-- Google Sign-In Button -->
                        <div class="wd-social-login">
                            <button type="button" class="wd-btn wd-btn-google" onclick="handleGoogleLogin()">
                                <svg class="google-icon" viewBox="0 0 24 24" width="20" height="20">
                                    <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                    <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                    <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                    <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                                </svg>
                                <span data-i18n="auth.continueWithGoogle">Continue with Google</span>
                            </button>
                        </div>

                        <div class="wd-auth-divider">
                            <span data-i18n="auth.or">or</span>
                        </div>

                        <div class="wd-form-group">
                            <label class="wd-form-label" for="login-email" data-i18n="auth.email">Email</label>
                            <input type="email" class="wd-input" id="login-email" placeholder="your@company.com" required>
                        </div>
                        <div class="wd-form-group">
                            <label class="wd-form-label" for="login-password" data-i18n="auth.password">Password</label>
                            <input type="password" class="wd-input" id="login-password" data-i18n-placeholder="auth.enterPassword" placeholder="Enter password" required>
                        </div>
                        <div class="wd-form-options">
                            <label class="wd-checkbox">
                                <input type="checkbox"> <span data-i18n="auth.rememberMe">Remember me</span>
                            </label>
                            <a href="#" class="wd-link" onclick="showForgotPassword(event)" data-i18n="auth.forgotPassword">Forgot password?</a>
                        </div>
                        <button type="submit" class="wd-btn wd-btn-primary wd-btn-full" data-i18n="auth.login" onclick="handleLogin(event)">Login</button>
                    </form>

                    <!-- Register Form -->
                    <form class="wd-auth-form" id="register-form" onsubmit="handleRegister(event)">
                        <h2 class="wd-auth-title" data-i18n="auth.joinWedealize">Join WeDealize</h2>
                        <p class="wd-auth-subtitle" data-i18n="auth.registerSubtitle">Register as a supplier partner</p>

                        <!-- Google Sign-In Button -->
                        <div class="wd-social-login">
                            <button type="button" class="wd-btn wd-btn-google" onclick="handleGoogleLogin()">
                                <svg class="google-icon" viewBox="0 0 24 24" width="20" height="20">
                                    <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                    <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                    <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                    <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                                </svg>
                                <span data-i18n="auth.continueWithGoogle">Continue with Google</span>
                            </button>
                        </div>

                        <div class="wd-auth-divider">
                            <span data-i18n="auth.or">or</span>
                        </div>

                        <div class="wd-form-group">
                            <label class="wd-form-label" for="reg-company"><span data-i18n="auth.companyName">Company Name</span> *</label>
                            <input type="text" class="wd-input" id="reg-company" data-i18n-placeholder="auth.companyName" placeholder="Company Name" required>
                        </div>
                        <div class="wd-form-group">
                            <label class="wd-form-label" for="reg-country"><span data-i18n="auth.country">Country</span> *</label>
                            <div class="wd-country-select" id="country-select">
                                <input type="hidden" id="reg-country" name="country" required>
                                <button type="button" class="wd-country-select-trigger" id="country-trigger">
                                    <img class="wd-country-select-flag" id="selected-flag" src="" alt="" style="display: none;">
                                    <span class="wd-country-select-text placeholder" id="selected-country" data-i18n="auth.selectCountry">Select country</span>
                                    <svg class="wd-country-select-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M6 9l6 6 6-6"/>
                                    </svg>
                                </button>
                                <div class="wd-country-select-dropdown" id="country-dropdown">
                                    <div class="wd-country-search">
                                        <input type="text" id="country-search" data-i18n-placeholder="auth.searchCountry" placeholder="Search country...">
                                    </div>
                                    <div class="wd-country-list" id="country-list">
                                        <!-- Africa (A-Z) -->
                                        <div class="wd-country-group-label" data-i18n="regions.africa">Africa</div>
                                        <div class="wd-country-option" data-value="EG" data-name="Egypt">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/eg.png" alt="EG">
                                            <span class="wd-country-option-name">Egypt</span>
                                        </div>
                                        <div class="wd-country-option" data-value="KE" data-name="Kenya">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/ke.png" alt="KE">
                                            <span class="wd-country-option-name">Kenya</span>
                                        </div>
                                        <div class="wd-country-option" data-value="NG" data-name="Nigeria">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/ng.png" alt="NG">
                                            <span class="wd-country-option-name">Nigeria</span>
                                        </div>
                                        <div class="wd-country-option" data-value="ZA" data-name="South Africa">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/za.png" alt="ZA">
                                            <span class="wd-country-option-name">South Africa</span>
                                        </div>
                                        <!-- Americas (A-Z) -->
                                        <div class="wd-country-group-label" data-i18n="regions.americas">Americas</div>
                                        <div class="wd-country-option" data-value="AR" data-name="Argentina">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/ar.png" alt="AR">
                                            <span class="wd-country-option-name">Argentina</span>
                                        </div>
                                        <div class="wd-country-option" data-value="BR" data-name="Brazil">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/br.png" alt="BR">
                                            <span class="wd-country-option-name">Brazil</span>
                                        </div>
                                        <div class="wd-country-option" data-value="CA" data-name="Canada">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/ca.png" alt="CA">
                                            <span class="wd-country-option-name">Canada</span>
                                        </div>
                                        <div class="wd-country-option" data-value="CL" data-name="Chile">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/cl.png" alt="CL">
                                            <span class="wd-country-option-name">Chile</span>
                                        </div>
                                        <div class="wd-country-option" data-value="CO" data-name="Colombia">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/co.png" alt="CO">
                                            <span class="wd-country-option-name">Colombia</span>
                                        </div>
                                        <div class="wd-country-option" data-value="MX" data-name="Mexico">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/mx.png" alt="MX">
                                            <span class="wd-country-option-name">Mexico</span>
                                        </div>
                                        <div class="wd-country-option" data-value="PE" data-name="Peru">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/pe.png" alt="PE">
                                            <span class="wd-country-option-name">Peru</span>
                                        </div>
                                        <div class="wd-country-option" data-value="US" data-name="United States">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/us.png" alt="US">
                                            <span class="wd-country-option-name">United States</span>
                                        </div>
                                        <!-- Asia (A-Z) -->
                                        <div class="wd-country-group-label" data-i18n="regions.asia">Asia</div>
                                        <div class="wd-country-option" data-value="CN" data-name="China">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/cn.png" alt="CN">
                                            <span class="wd-country-option-name">China</span>
                                        </div>
                                        <div class="wd-country-option" data-value="HK" data-name="Hong Kong">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/hk.png" alt="HK">
                                            <span class="wd-country-option-name">Hong Kong</span>
                                        </div>
                                        <div class="wd-country-option" data-value="IN" data-name="India">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/in.png" alt="IN">
                                            <span class="wd-country-option-name">India</span>
                                        </div>
                                        <div class="wd-country-option" data-value="ID" data-name="Indonesia">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/id.png" alt="ID">
                                            <span class="wd-country-option-name">Indonesia</span>
                                        </div>
                                        <div class="wd-country-option" data-value="JP" data-name="Japan">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/jp.png" alt="JP">
                                            <span class="wd-country-option-name">Japan</span>
                                        </div>
                                        <div class="wd-country-option" data-value="MY" data-name="Malaysia">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/my.png" alt="MY">
                                            <span class="wd-country-option-name">Malaysia</span>
                                        </div>
                                        <div class="wd-country-option" data-value="PH" data-name="Philippines">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/ph.png" alt="PH">
                                            <span class="wd-country-option-name">Philippines</span>
                                        </div>
                                        <div class="wd-country-option" data-value="SG" data-name="Singapore">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/sg.png" alt="SG">
                                            <span class="wd-country-option-name">Singapore</span>
                                        </div>
                                        <div class="wd-country-option" data-value="KR" data-name="South Korea">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/kr.png" alt="KR">
                                            <span class="wd-country-option-name">South Korea</span>
                                        </div>
                                        <div class="wd-country-option" data-value="TW" data-name="Taiwan">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/tw.png" alt="TW">
                                            <span class="wd-country-option-name">Taiwan</span>
                                        </div>
                                        <div class="wd-country-option" data-value="TH" data-name="Thailand">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/th.png" alt="TH">
                                            <span class="wd-country-option-name">Thailand</span>
                                        </div>
                                        <div class="wd-country-option" data-value="VN" data-name="Vietnam">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/vn.png" alt="VN">
                                            <span class="wd-country-option-name">Vietnam</span>
                                        </div>
                                        <!-- Europe (A-Z) -->
                                        <div class="wd-country-group-label" data-i18n="regions.europe">Europe</div>
                                        <div class="wd-country-option" data-value="AT" data-name="Austria">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/at.png" alt="AT">
                                            <span class="wd-country-option-name">Austria</span>
                                        </div>
                                        <div class="wd-country-option" data-value="BE" data-name="Belgium">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/be.png" alt="BE">
                                            <span class="wd-country-option-name">Belgium</span>
                                        </div>
                                        <div class="wd-country-option" data-value="CZ" data-name="Czech Republic">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/cz.png" alt="CZ">
                                            <span class="wd-country-option-name">Czech Republic</span>
                                        </div>
                                        <div class="wd-country-option" data-value="DK" data-name="Denmark">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/dk.png" alt="DK">
                                            <span class="wd-country-option-name">Denmark</span>
                                        </div>
                                        <div class="wd-country-option" data-value="FI" data-name="Finland">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/fi.png" alt="FI">
                                            <span class="wd-country-option-name">Finland</span>
                                        </div>
                                        <div class="wd-country-option" data-value="FR" data-name="France">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/fr.png" alt="FR">
                                            <span class="wd-country-option-name">France</span>
                                        </div>
                                        <div class="wd-country-option" data-value="DE" data-name="Germany">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/de.png" alt="DE">
                                            <span class="wd-country-option-name">Germany</span>
                                        </div>
                                        <div class="wd-country-option" data-value="GR" data-name="Greece">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/gr.png" alt="GR">
                                            <span class="wd-country-option-name">Greece</span>
                                        </div>
                                        <div class="wd-country-option" data-value="HU" data-name="Hungary">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/hu.png" alt="HU">
                                            <span class="wd-country-option-name">Hungary</span>
                                        </div>
                                        <div class="wd-country-option" data-value="IE" data-name="Ireland">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/ie.png" alt="IE">
                                            <span class="wd-country-option-name">Ireland</span>
                                        </div>
                                        <div class="wd-country-option" data-value="IT" data-name="Italy">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/it.png" alt="IT">
                                            <span class="wd-country-option-name">Italy</span>
                                        </div>
                                        <div class="wd-country-option" data-value="NL" data-name="Netherlands">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/nl.png" alt="NL">
                                            <span class="wd-country-option-name">Netherlands</span>
                                        </div>
                                        <div class="wd-country-option" data-value="NO" data-name="Norway">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/no.png" alt="NO">
                                            <span class="wd-country-option-name">Norway</span>
                                        </div>
                                        <div class="wd-country-option" data-value="PL" data-name="Poland">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/pl.png" alt="PL">
                                            <span class="wd-country-option-name">Poland</span>
                                        </div>
                                        <div class="wd-country-option" data-value="PT" data-name="Portugal">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/pt.png" alt="PT">
                                            <span class="wd-country-option-name">Portugal</span>
                                        </div>
                                        <div class="wd-country-option" data-value="RO" data-name="Romania">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/ro.png" alt="RO">
                                            <span class="wd-country-option-name">Romania</span>
                                        </div>
                                        <div class="wd-country-option" data-value="RU" data-name="Russia">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/ru.png" alt="RU">
                                            <span class="wd-country-option-name">Russia</span>
                                        </div>
                                        <div class="wd-country-option" data-value="ES" data-name="Spain">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/es.png" alt="ES">
                                            <span class="wd-country-option-name">Spain</span>
                                        </div>
                                        <div class="wd-country-option" data-value="SE" data-name="Sweden">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/se.png" alt="SE">
                                            <span class="wd-country-option-name">Sweden</span>
                                        </div>
                                        <div class="wd-country-option" data-value="CH" data-name="Switzerland">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/ch.png" alt="CH">
                                            <span class="wd-country-option-name">Switzerland</span>
                                        </div>
                                        <div class="wd-country-option" data-value="TR" data-name="Turkey">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/tr.png" alt="TR">
                                            <span class="wd-country-option-name">Turkey</span>
                                        </div>
                                        <div class="wd-country-option" data-value="UA" data-name="Ukraine">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/ua.png" alt="UA">
                                            <span class="wd-country-option-name">Ukraine</span>
                                        </div>
                                        <div class="wd-country-option" data-value="GB" data-name="United Kingdom">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/gb.png" alt="GB">
                                            <span class="wd-country-option-name">United Kingdom</span>
                                        </div>
                                        <!-- Middle East (A-Z) -->
                                        <div class="wd-country-group-label" data-i18n="regions.middleEast">Middle East</div>
                                        <div class="wd-country-option" data-value="IL" data-name="Israel">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/il.png" alt="IL">
                                            <span class="wd-country-option-name">Israel</span>
                                        </div>
                                        <div class="wd-country-option" data-value="SA" data-name="Saudi Arabia">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/sa.png" alt="SA">
                                            <span class="wd-country-option-name">Saudi Arabia</span>
                                        </div>
                                        <div class="wd-country-option" data-value="AE" data-name="United Arab Emirates">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/ae.png" alt="AE">
                                            <span class="wd-country-option-name">United Arab Emirates</span>
                                        </div>
                                        <!-- Oceania (A-Z) -->
                                        <div class="wd-country-group-label" data-i18n="regions.oceania">Oceania</div>
                                        <div class="wd-country-option" data-value="AU" data-name="Australia">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/au.png" alt="AU">
                                            <span class="wd-country-option-name">Australia</span>
                                        </div>
                                        <div class="wd-country-option" data-value="NZ" data-name="New Zealand">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/nz.png" alt="NZ">
                                            <span class="wd-country-option-name">New Zealand</span>
                                        </div>
                                        <!-- Other -->
                                        <div class="wd-country-group-label" data-i18n="regions.other">Other</div>
                                        <div class="wd-country-option" data-value="OTHER" data-name="Other">
                                            <img class="wd-country-option-flag" src="https://flagcdn.com/w40/un.png" alt="OTHER">
                                            <span class="wd-country-option-name">Other</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="wd-form-group">
                            <label class="wd-form-label" for="reg-email"><span data-i18n="auth.businessEmail">Business Email</span> *</label>
                            <input type="email" class="wd-input" id="reg-email" placeholder="sales@company.com" required>
                        </div>
                        <div class="wd-form-group">
                            <label class="wd-form-label" for="reg-password"><span data-i18n="auth.password">Password</span> *</label>
                            <input type="password" class="wd-input" id="reg-password" data-i18n-placeholder="auth.minChars" placeholder="Minimum 8 characters" required minlength="8">
                        </div>
                        <div class="wd-form-group">
                            <label class="wd-form-label"><span data-i18n="auth.productCategory">Product Categories</span> * <span class="wd-badge wd-badge-outline" id="reg-category-count" style="font-size:11px;margin-left:6px">0 selected</span></label>
                            <input type="text" class="wd-input" id="reg-category-search" placeholder="Search categories..." oninput="filterRegCategories(this.value)" style="margin-bottom:8px">
                            <div id="reg-categories-container" style="max-height:320px;overflow-y:auto;border:1px solid var(--wd-gray-200);border-radius:var(--wd-radius-md);padding:12px">
                                <!-- Populated by JS via renderCategoryCheckboxGrid() -->
                            </div>
                        </div>
                        <div class="wd-form-options">
                            <label class="wd-checkbox">
                                <input type="checkbox" required> <span data-i18n="auth.agreeTerms">I agree to the</span> <a href="#" class="wd-link" data-i18n="auth.termsOfService">Terms of Service</a>
                            </label>
                        </div>
                        <button type="submit" class="wd-btn wd-btn-primary wd-btn-full" data-i18n="auth.createAccount">Create Account</button>
                    </form>

                    <!-- Email Verification Form -->
                    <div class="wd-auth-form" id="verify-form" style="display: none;">
                        <h2 class="wd-auth-title" data-i18n="verification.verifyEmail">Verify Your Email</h2>
                        <p class="wd-auth-subtitle"><span data-i18n="verification.codeSentTo">We sent a verification code to</span> <strong id="verify-email-display"></strong></p>

                        <div class="wd-verification-icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="var(--wd-primary)" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                        </div>

                        <div class="wd-form-group">
                            <label class="wd-form-label" data-i18n="verification.enterCode">Enter 6-digit code</label>
                            <div class="wd-verification-inputs">
                                <input type="text" maxlength="1" class="wd-code-input" data-index="0" oninput="handleCodeInput(event)" onkeydown="handleCodeKeydown(event)" onpaste="handleCodePaste(event)">
                                <input type="text" maxlength="1" class="wd-code-input" data-index="1" oninput="handleCodeInput(event)" onkeydown="handleCodeKeydown(event)" onpaste="handleCodePaste(event)">
                                <input type="text" maxlength="1" class="wd-code-input" data-index="2" oninput="handleCodeInput(event)" onkeydown="handleCodeKeydown(event)" onpaste="handleCodePaste(event)">
                                <input type="text" maxlength="1" class="wd-code-input" data-index="3" oninput="handleCodeInput(event)" onkeydown="handleCodeKeydown(event)" onpaste="handleCodePaste(event)">
                                <input type="text" maxlength="1" class="wd-code-input" data-index="4" oninput="handleCodeInput(event)" onkeydown="handleCodeKeydown(event)" onpaste="handleCodePaste(event)">
                                <input type="text" maxlength="1" class="wd-code-input" data-index="5" oninput="handleCodeInput(event)" onkeydown="handleCodeKeydown(event)" onpaste="handleCodePaste(event)">
                            </div>
                        </div>

                        <button type="button" class="wd-btn wd-btn-primary wd-btn-full" onclick="verifyEmail()" data-i18n="verification.verifyButton">Verify Email</button>

                        <div class="wd-resend-section">
                            <p><span data-i18n="verification.didntReceive">Didn't receive the code?</span> <button type="button" class="wd-btn-link" id="resend-btn" onclick="resendVerificationCode()" data-i18n="verification.resend">Resend</button></p>
                            <p class="wd-resend-timer" id="resend-timer" style="display: none;"><span data-i18n="verification.resendIn">Resend available in</span> <span id="timer-count">60</span>s</p>
                        </div>

                        <button type="button" class="wd-btn wd-btn-outline wd-btn-full" onclick="backToRegister()" data-i18n="verification.backToRegister">Back to Register</button>
                    </div>

                    <!-- Forgot Password Form -->
                    <div class="wd-auth-form" id="forgot-form" style="display: none;">
                        <h2 class="wd-auth-title" data-i18n="passwordReset.resetPassword">Reset Password</h2>
                        <p class="wd-auth-subtitle" data-i18n="passwordReset.enterEmail">Enter your email to receive a reset link</p>

                        <div class="wd-form-group">
                            <label class="wd-form-label" for="forgot-email" data-i18n="auth.email">Email</label>
                            <input type="email" class="wd-input" id="forgot-email" placeholder="your@company.com" required>
                        </div>

                        <button type="button" class="wd-btn wd-btn-primary wd-btn-full" onclick="sendResetLink()" data-i18n="passwordReset.sendResetLink">Send Reset Link</button>

                        <button type="button" class="wd-btn wd-btn-outline wd-btn-full" style="margin-top: 12px;" onclick="backToLogin()" data-i18n="passwordReset.backToLogin">Back to Login</button>
                    </div>

                    <!-- Password Reset Sent -->
                    <div class="wd-auth-form" id="reset-sent-form" style="display: none;">
                        <div class="wd-success-icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="var(--wd-success)" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                        </div>
                        <h2 class="wd-auth-title" data-i18n="passwordReset.checkEmail">Check Your Email</h2>
                        <p class="wd-auth-subtitle"><span data-i18n="passwordReset.resetLinkSent">We sent a password reset link to</span> <strong id="reset-email-display"></strong></p>

                        <div class="wd-reset-instructions">
                            <p data-i18n="passwordReset.linkExpires">Click the link in the email to reset your password. The link will expire in 24 hours.</p>
                        </div>

                        <button type="button" class="wd-btn wd-btn-outline wd-btn-full" onclick="backToLogin()" data-i18n="passwordReset.backToLogin">Back to Login</button>
                    </div>
                </div>
            </section>

            <!-- Dashboard Section (after login) -->
            <section class="dashboard-section" id="dashboard-section" style="display: none;">
                <div class="dashboard-container">
                    <!-- Sidebar (loaded from js/sidebar.js) -->
                    <aside class="wd-sidebar"></aside>

                    <!-- Main Dashboard Content -->
                    <div class="dashboard-content">
                        <!-- Overview -->
                        <div class="dashboard-panel active" id="panel-overview">
                            <div class="wd-page-header">
                                <div>
                                    <h2 class="wd-page-title" data-i18n="dashboard.dashboardOverview">Dashboard</h2>
                                    <p class="wd-page-subtitle" data-i18n="dashboard.overviewSubtitle">Overview of your supplier activities</p>
                                </div>
                            </div>

                            <!-- Summary Stats Cards -->
                            <div class="wd-stats-grid" style="padding: 24px;">
                                <div class="wd-stat-card">
                                    <div class="wd-stat-icon wd-stat-icon-success">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                                    </div>
                                    <div class="wd-stat-content">
                                        <span class="wd-stat-value" id="stat-monthly-orders">$0</span>
                                        <span class="wd-stat-label" data-i18n="dashboard.monthlyOrders">This Month Orders</span>
                                    </div>
                                </div>
                                <div class="wd-stat-card">
                                    <div class="wd-stat-icon wd-stat-icon-primary">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>
                                    </div>
                                    <div class="wd-stat-content">
                                        <span class="wd-stat-value" id="stat-products">0</span>
                                        <span class="wd-stat-label" data-i18n="dashboard.productsListed">Products Listed</span>
                                    </div>
                                </div>
                                <div class="wd-stat-card">
                                    <div class="wd-stat-icon wd-stat-icon-teal">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                                    </div>
                                    <div class="wd-stat-content">
                                        <span class="wd-stat-value" id="stat-completeness">0%</span>
                                        <span class="wd-stat-label" data-i18n="dashboard.dataCompleteness">Data Completeness</span>
                                    </div>
                                </div>
                                <div class="wd-stat-card">
                                    <div class="wd-stat-icon wd-stat-icon-blue">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                                    </div>
                                    <div class="wd-stat-content">
                                        <span class="wd-stat-value" id="stat-active-buyers">0</span>
                                        <span class="wd-stat-label" data-i18n="dashboard.activeBuyers">Active Buyers</span>
                                    </div>
                                </div>
                            </div>

                            <div class="wd-dashboard-grid" style="padding: 0 24px 24px; border-top: 1px solid var(--wd-gray-100);">
                                <!-- Left Column: Action-Focused (Workflow Priority) -->
                                <div class="wd-dashboard-left">
                                    <!-- 1. Action Required (Highest Priority - Urgent Items) -->
                                    <div class="wd-card wd-card-action-required">
                                        <div class="wd-card-header">
                                            <h3 class="wd-card-title">
                                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
                                                <span data-i18n="dashboard.actionRequired">Action Required</span>
                                            </h3>
                                            <span class="wd-badge wd-badge-warning" id="action-required-count">0</span>
                                        </div>
                                        <div class="wd-card-body">
                                            <div class="wd-action-list" id="action-required-list">
                                                <!-- Data loaded dynamically via API -->
                                                <div class="wd-empty-state" style="padding: 16px; text-align: center; color: var(--wd-gray-400);">
                                                    <p>No actions required</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 2. Quick Actions (Frequently Used Tasks) -->
                                    <div class="wd-card">
                                        <div class="wd-card-header">
                                            <h3 class="wd-card-title">
                                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
                                                <span data-i18n="dashboard.quickActions">Quick Actions</span>
                                            </h3>
                                        </div>
                                        <div class="wd-card-body">
                                            <div class="wd-quick-actions">
                                                <button class="wd-quick-action-btn" onclick="openAddPOModal()">
                                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="12" y1="18" x2="12" y2="12"/><line x1="9" y1="15" x2="15" y2="15"/></svg>
                                                    <span data-i18n="dashboard.registerPO">Register PO</span>
                                                </button>
                                                <button class="wd-quick-action-btn" onclick="openINVModal()">
                                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
                                                    <span data-i18n="dashboard.addINV">Add INV</span>
                                                </button>
                                                <button class="wd-quick-action-btn" onclick="showSection('catalog-registration')">
                                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                                                    <span data-i18n="dashboard.addProducts">Add Products</span>
                                                </button>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 3. Recent Activity (Workflow Timeline) -->
                                    <div class="wd-card">
                                        <div class="wd-card-header">
                                            <h3 class="wd-card-title">
                                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                                                <span data-i18n="dashboard.recentActivity">Recent Activity</span>
                                            </h3>
                                            <a href="#" class="wd-card-link" onclick="showSection('po-management'); return false;" data-i18n="common.viewAll">View All</a>
                                        </div>
                                        <div class="wd-card-body">
                                            <div class="wd-activity-list" id="recent-activity-list">
                                                <!-- Data loaded dynamically via API -->
                                                <div class="wd-empty-state" style="padding: 24px; text-align: center; color: var(--wd-gray-400);">
                                                    <p>No recent activity</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Right Column: Performance & Insights -->
                                <div class="wd-dashboard-right">
                                    <!-- 1. This Month Performance (Key Metrics) -->
                                    <div class="wd-card">
                                        <div class="wd-card-header">
                                            <h3 class="wd-card-title">
                                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>
                                                <span data-i18n="dashboard.thisMonth">This Month</span>
                                            </h3>
                                        </div>
                                        <div class="wd-card-body">
                                            <div class="wd-performance-grid">
                                                <div class="wd-performance-item">
                                                    <span class="wd-performance-value" id="perf-orders-received">0</span>
                                                    <span class="wd-performance-label" data-i18n="dashboard.ordersReceived">Orders Received</span>
                                                </div>
                                                <div class="wd-performance-item">
                                                    <span class="wd-performance-value" id="perf-order-amount">$0</span>
                                                    <span class="wd-performance-label" data-i18n="dashboard.orderAmount">Order Amount</span>
                                                </div>
                                                <div class="wd-performance-item">
                                                    <span class="wd-performance-value" id="perf-inv-issued">0</span>
                                                    <span class="wd-performance-label" data-i18n="dashboard.invIssued">INV Issued</span>
                                                </div>
                                                <div class="wd-performance-item">
                                                    <span class="wd-performance-value" id="perf-inv-amount">$0</span>
                                                    <span class="wd-performance-label" data-i18n="dashboard.invAmount">INV Amount</span>
                                                </div>
                                            </div>
                                            <!-- Top Buyers inline -->
                                            <div class="wd-top-buyers-compact">
                                                <div class="wd-section-divider"></div>
                                                <div class="wd-compact-header">
                                                    <span class="wd-compact-title" data-i18n="dashboard.topBuyers">Top Buyers</span>
                                                    <a href="#" class="wd-card-link" onclick="showSection('accounts'); return false;" data-i18n="common.viewAll">View All</a>
                                                </div>
                                                <div class="wd-buyer-list-compact" id="top-buyers-list">
                                                    <!-- Data loaded dynamically via API -->
                                                    <div class="wd-empty-state" style="padding: 12px; text-align: center; color: var(--wd-gray-400); font-size: 13px;">
                                                        <p>No buyers yet</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Payment Collection Rate -->
                                    <div class="wd-card">
                                        <div class="wd-card-header">
                                            <h3 class="wd-card-title">
                                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                                                <span data-i18n="dashboard.paymentCollection">Payment Collection</span>
                                            </h3>
                                            <a href="#" class="wd-card-link" onclick="showSection('inv-management'); return false;" data-i18n="common.viewAll">View All</a>
                                        </div>
                                        <div class="wd-card-body">
                                            <div class="wd-progress-section">
                                                <div class="wd-progress-header">
                                                    <span data-i18n="dashboard.collectionRate">Collection Rate</span>
                                                    <span class="wd-progress-value wd-text-muted" id="collection-rate">0%</span>
                                                </div>
                                                <div class="wd-progress-bar">
                                                    <div class="wd-progress-fill wd-progress-fill-success" id="collection-rate-bar" style="width: 0%;"></div>
                                                </div>
                                            </div>
                                            <div class="wd-payment-stats" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 16px;">
                                                <div class="wd-payment-stat">
                                                    <span class="wd-payment-stat-value" id="payment-total-sent">$0</span>
                                                    <span class="wd-payment-stat-label wd-text-muted" data-i18n="dashboard.totalSent">Total Sent</span>
                                                </div>
                                                <div class="wd-payment-stat">
                                                    <span class="wd-payment-stat-value wd-text-success" id="payment-collected">$0</span>
                                                    <span class="wd-payment-stat-label wd-text-muted" data-i18n="dashboard.collected">Collected</span>
                                                </div>
                                                <div class="wd-payment-stat">
                                                    <span class="wd-payment-stat-value wd-text-warning" id="payment-outstanding">$0</span>
                                                    <span class="wd-payment-stat-label wd-text-muted" data-i18n="dashboard.outstanding">Outstanding</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 2. Product Status (Data Quality - Maintenance) -->
                                    <div class="wd-card">
                                        <div class="wd-card-header">
                                            <h3 class="wd-card-title">
                                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>
                                                <span data-i18n="dashboard.productStatus">Product Status</span>
                                            </h3>
                                            <a href="#" class="wd-card-link" onclick="showSection('product-list'); return false;" data-i18n="common.viewAll">View All</a>
                                        </div>
                                        <div class="wd-card-body">
                                            <div class="wd-progress-section">
                                                <div class="wd-progress-header">
                                                    <span data-i18n="dashboard.dataCompleteness">Data Completeness</span>
                                                    <span class="wd-progress-value" id="dash-completeness-pct">-</span>
                                                </div>
                                                <div class="wd-progress-bar">
                                                    <div class="wd-progress-fill" id="dash-completeness-bar" style="width: 0%;"></div>
                                                </div>
                                            </div>
                                            <div class="wd-incomplete-list">
                                                <div class="wd-incomplete-item">
                                                    <span class="wd-incomplete-label" data-i18n="dashboard.missingMOQ">Missing MOQ</span>
                                                    <span class="wd-incomplete-count" id="dash-missing-moq">-</span>
                                                </div>
                                                <div class="wd-incomplete-item">
                                                    <span class="wd-incomplete-label" data-i18n="dashboard.missingPrice">Missing Price</span>
                                                    <span class="wd-incomplete-count" id="dash-missing-price">-</span>
                                                </div>
                                                <div class="wd-incomplete-item">
                                                    <span class="wd-incomplete-label" data-i18n="dashboard.missingCerts">Missing Certifications</span>
                                                    <span class="wd-incomplete-count" id="dash-missing-certs">-</span>
                                                </div>
                                            </div>
                                            <button class="wd-btn wd-btn-outline wd-btn-sm" onclick="showSection('product-list')" style="width: 100%; margin-top: 12px;">
                                                <span data-i18n="dashboard.completeNow">Complete Now</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Catalog Registration -->
                        <div class="dashboard-panel" id="panel-catalog">
                            <!-- Page Header -->
                            <div class="wd-page-header">
                                <div class="wd-page-header-content">
                                    <h2 class="wd-page-title" data-i18n="catalog.registrationTitle">Catalog Registration</h2>
                                    <p class="wd-page-subtitle" data-i18n="catalog.registrationSubtitle">Upload and manage your product catalog</p>
                                </div>
                            </div>

                            <!-- Step Indicator -->
                            <div class="wd-steps" style="padding: 24px;">
                                <div class="wd-step active" id="step-indicator-1">
                                    <div class="wd-step-number"><span>1</span></div>
                                    <div class="wd-step-label" data-i18n="catalog.step1">Upload Catalog</div>
                                </div>
                                <div class="wd-step-connector" id="connector-1"></div>
                                <div class="wd-step" id="step-indicator-2">
                                    <div class="wd-step-number"><span>2</span></div>
                                    <div class="wd-step-label" data-i18n="catalog.step2">Review Products</div>
                                </div>
                                <div class="wd-step-connector" id="connector-2"></div>
                                <div class="wd-step" id="step-indicator-3">
                                    <div class="wd-step-number"><span>3</span></div>
                                    <div class="wd-step-label" data-i18n="catalog.step4">Complete</div>
                                </div>
                            </div>

                            <!-- Step 1: Upload Catalog -->
                            <div id="catalog-step-1">
                                <div class="wd-card">
                                    <div class="wd-card-header wd-flex wd-items-center wd-gap-3">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                                        <h3 class="wd-card-title" data-i18n="catalog.uploadCatalogTitle">Upload Product Catalog</h3>
                                    </div>
                                    <div class="wd-card-body">
                                        <p class="wd-form-hint wd-mb-5" data-i18n="catalog.catalogDescription">Upload your product catalog file. We'll automatically extract product information.</p>

                                        <div class="wd-dropzone" id="catalog-dropzone"
                                             ondrop="handleDrop(event, 'catalog')"
                                             ondragover="handleDragOver(event)"
                                             ondragleave="handleDragLeave(event)">
                                            <input type="file" id="catalog-file" accept=".pdf,.xlsx,.xls,.csv" onchange="handleFileSelect(event, 'catalog')" hidden>
                                            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                                <polyline points="17 8 12 3 7 8"/>
                                                <line x1="12" y1="3" x2="12" y2="15"/>
                                            </svg>
                                            <p><span data-i18n="catalog.dragDrop">Drag & drop or</span> <label for="catalog-file" class="wd-link" data-i18n="catalog.browse">browse</label></p>
                                            <span class="wd-dropzone-hint" data-i18n="catalog.fileHint">PDF, Excel, CSV (Max 50MB)</span>
                                        </div>
                                        <div class="wd-file-list" id="catalog-uploaded" style="display: none;">
                                            <div class="wd-file-item">
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                                                <span class="wd-file-name" id="catalog-filename"></span>
                                                <span class="wd-file-size" id="catalog-filesize"></span>
                                                <button type="button" class="wd-btn-icon" onclick="removeFile('catalog')">
                                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                                                </button>
                                            </div>
                                        </div>

                                        <div style="margin-top: 24px; text-align: right;">
                                            <button class="wd-btn wd-btn-primary wd-btn-lg" onclick="extractCatalog()" id="extract-btn" disabled>
                                                <span data-i18n="catalog.extractProducts">Extract Products</span>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
                                            </button>
                                        </div>

                                        <!-- Extraction Progress -->
                                        <div id="extraction-progress" style="display: none; margin-top: 20px;">
                                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                                <span id="extraction-status-text" style="font-size: 14px; color: var(--text-secondary);">Preparing...</span>
                                                <span id="extraction-progress-pct" style="font-size: 14px; font-weight: 600; color: var(--primary);">0%</span>
                                            </div>
                                            <div style="width: 100%; height: 8px; background: var(--bg-secondary); border-radius: 4px; overflow: hidden;">
                                                <div id="extraction-progress-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, var(--primary), var(--primary-dark, #1a5c3a)); border-radius: 4px; transition: width 0.3s ease;"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 2: Review Extracted Products -->
                            <div id="catalog-step-2" style="display: none; padding: 0 24px 24px;">
                                <div class="wd-card">
                                    <div class="wd-card-header" style="display: flex; align-items: center; justify-content: space-between;">
                                        <div class="wd-flex wd-items-center wd-gap-3">
                                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
                                            <h3 class="wd-card-title" data-i18n="catalog.reviewExtracted">Review Extracted Products</h3>
                                        </div>
                                        <span class="wd-badge wd-badge-info"><span id="extracted-total">0</span> products extracted</span>
                                    </div>
                                    <div class="wd-card-body">
                                        <div class="wd-mb-3" style="color: var(--text-secondary); font-size: 14px;">
                                            Select the products you want to register. You can edit details before proceeding.
                                        </div>

                                        <table class="wd-table">
                                            <thead>
                                                <tr>
                                                    <th style="width: 36px;"><input type="checkbox" id="select-all-extracted" onchange="toggleSelectAllExtracted()"></th>
                                                    <th style="width: 12%;">Brand</th>
                                                    <th style="width: auto;">Product</th>
                                                    <th style="width: 8%;">Spec</th>
                                                    <th style="width: 14%;">Category</th>
                                                    <th style="width: 9%;">Price</th>
                                                    <th style="width: 7%;">Basis</th>
                                                    <th style="width: 10%;">Shelf Life</th>
                                                </tr>
                                            </thead>
                                            <tbody id="extracted-products-tbody">
                                                <!-- Dynamic content -->
                                            </tbody>
                                        </table>

                                        <div style="display: flex; justify-content: space-between; margin-top: 24px;">
                                            <button class="wd-btn wd-btn-outline" onclick="goToCatalogStep(1)">
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
                                                <span data-i18n="catalog.uploadDifferent">Upload Different File</span>
                                            </button>
                                            <button class="wd-btn wd-btn-primary wd-btn-lg" onclick="goToCatalogStep(3)">
                                                <span>Register Products</span>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 3: Complete -->
                            <div id="catalog-step-3" style="display: none; padding: 0 24px 24px;">
                                <div class="wd-card" style="text-align: center; padding: 48px;">
                                    <div class="wd-complete-icon" style="width: 64px; height: 64px; margin: 0 auto 24px; background: var(--wd-success-light); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#2e7d32" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                                    </div>
                                    <h3 style="font-size: 20px; font-weight: 600; margin-bottom: 12px;" data-i18n="catalog.registrationComplete">Registration Complete!</h3>
                                    <p style="color: var(--wd-gray-600); margin-bottom: 24px;">
                                        <span id="registered-count">0</span> <span data-i18n="catalog.productsRegistered">products have been registered.</span>
                                    </p>

                                    <p style="color: var(--wd-gray-500); margin-bottom: 24px;">You can view and manage your products in the Product List.</p>

                                    <div style="display: flex; gap: 12px; justify-content: center;">
                                        <button class="wd-btn wd-btn-outline" onclick="startNewCatalog()">
                                            <span data-i18n="catalog.registerAnother">Register Another Catalog</span>
                                        </button>
                                        <button class="wd-btn wd-btn-primary" onclick="showSection('product-list')">
                                            <span data-i18n="catalog.viewProductList">View Product List</span>
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Upload History -->
                            <div class="wd-card">
                                <div class="wd-card-header">
                                    <h3 class="wd-card-title" data-i18n="catalog.uploadHistory">Upload History</h3>
                                </div>
                                <div class="wd-card-body" style="padding: 0;">
                                    <table class="wd-table">
                                        <thead>
                                            <tr>
                                                <th data-i18n="catalog.fileName">File Name</th>
                                                <th data-i18n="catalog.type">Type</th>
                                                <th data-i18n="catalog.uploaded">Uploaded</th>
                                                <th data-i18n="catalog.status">Status</th>
                                                <th data-i18n="catalog.products">Products</th>
                                                <th data-i18n="catalog.actions">Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="upload-history-tbody">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Product List -->
                        <div class="dashboard-panel" id="panel-product-list">
                            <!-- Page Header -->
                            <div class="wd-page-header">
                                <div class="wd-page-header-content">
                                    <h2 class="wd-page-title" data-i18n="products.listTitle">Product List</h2>
                                    <p class="wd-page-subtitle" data-i18n="products.listSubtitle">Manage your product catalog and inventory</p>
                                </div>
                                <div class="wd-page-actions">
                                    <button class="wd-btn wd-btn-primary" onclick="openAddProductModal()">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                                        <span data-i18n="products.addProduct">Add Product</span>
                                    </button>
                                </div>
                            </div>

                            <!-- Data Quality Summary Card -->
                            <div class="wd-dq-card" style="margin: 24px 24px 0;">
                                <div class="wd-dq-header">
                                    <div class="wd-dq-score" id="quality-ring">
                                        <svg class="wd-dq-ring-svg" viewBox="0 0 120 120">
                                            <circle class="wd-dq-ring-bg" cx="60" cy="60" r="52" />
                                            <circle class="wd-dq-ring-fill" id="dq-ring-circle" cx="60" cy="60" r="52" stroke-dasharray="326.73" stroke-dashoffset="326.73" />
                                        </svg>
                                        <div class="wd-dq-score-text">
                                            <span class="wd-dq-pct" id="quality-ring-value">-</span>
                                            <span class="wd-dq-score-label">Complete</span>
                                        </div>
                                    </div>
                                    <div class="wd-dq-summary" id="dq-summary">
                                        <span class="wd-dq-summary-text">Loading...</span>
                                    </div>
                                </div>
                                <div class="wd-dq-fields" id="quality-checklist">
                                </div>
                            </div>

                            <!-- Filter Bar -->
                            <div class="wd-filter-bar">
                                <div class="wd-search">
                                    <svg class="wd-search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="11" cy="11" r="8"></circle>
                                        <path d="m21 21-4.3-4.3"></path>
                                    </svg>
                                    <input type="text" id="product-search" class="wd-input" placeholder="Search product, SKU..." oninput="searchProducts()">
                                </div>
                                <button class="wd-btn wd-btn-outline" onclick="exportProducts()" data-i18n="products.exportCSV">Export CSV</button>
                            </div>

                            <!-- Hidden filter value holders -->
                            <input type="hidden" id="pf-category-value" value="">
                            <input type="hidden" id="pf-cert-value" value="">
                            <input type="hidden" id="pf-status-value" value="">

                            <!-- Products Table -->
                            <div class="wd-section-x">
                                <table class="wd-table">
                                    <thead>
                                        <tr>
                                            <th data-i18n="products.product">Product</th>
                                            <th class="th-filter">
                                                <span data-i18n="modal.category">Category</span>
                                                <div class="wd-column-filter">
                                                    <button class="wd-filter-btn" onclick="toggleProductFilter(event, 'pf-category-dropdown')">
                                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                                                        </svg>
                                                    </button>
                                                    <div class="wd-filter-dropdown" id="pf-category-dropdown">
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="pf-category" value="" checked onchange="applyProductFilter('category','')">
                                                            <span>All</span>
                                                        </label>
                                                        <!-- dynamic options populated by JS -->
                                                    </div>
                                                </div>
                                            </th>
                                            <th data-i18n="products.sku">SKU</th>
                                            <th data-i18n="products.priceFOB">Price (FOB)</th>
                                            <th data-i18n="products.moq">MOQ</th>
                                            <th class="th-filter">
                                                <span data-i18n="modal.certifications">Certifications</span>
                                                <div class="wd-column-filter">
                                                    <button class="wd-filter-btn" onclick="toggleProductFilter(event, 'pf-cert-dropdown')">
                                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                                                        </svg>
                                                    </button>
                                                    <div class="wd-filter-dropdown" id="pf-cert-dropdown">
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="pf-cert" value="" checked onchange="applyProductFilter('cert','')">
                                                            <span>All</span>
                                                        </label>
                                                        <!-- dynamic options populated by JS -->
                                                    </div>
                                                </div>
                                            </th>
                                            <th class="th-filter">
                                                <span data-i18n="catalog.status">Status</span>
                                                <div class="wd-column-filter">
                                                    <button class="wd-filter-btn" onclick="toggleProductFilter(event, 'pf-status-dropdown')">
                                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                                                        </svg>
                                                    </button>
                                                    <div class="wd-filter-dropdown" id="pf-status-dropdown">
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="pf-status" value="" checked onchange="applyProductFilter('status','')">
                                                            <span>All</span>
                                                        </label>
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="pf-status" value="complete" onchange="applyProductFilter('status','complete')">
                                                            <span>Complete</span>
                                                        </label>
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="pf-status" value="incomplete" onchange="applyProductFilter('status','incomplete')">
                                                            <span>Incomplete</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </th>
                                            <th>Created By</th>
                                        </tr>
                                    </thead>
                                    <tbody id="product-list-tbody">
                                        <!-- Data loaded dynamically via API -->
                                    </tbody>
                                </table>
                            </div>

                            <!-- Pagination (dynamic) -->
                            <div id="product-list-pagination" class="wd-pagination" style="padding: 16px 24px; display: none;">
                            </div>
                        </div>


                        <!-- PO Management -->
                        <div class="dashboard-panel" id="panel-po-management">
                            <!-- Page Header -->
                            <div class="wd-page-header">
                                <div class="wd-page-header-content">
                                    <h2 class="wd-page-title" data-i18n="sales.poManagement">PO Management</h2>
                                    <p class="wd-page-subtitle" data-i18n="sales.poSubtitle">Track and manage Purchase Orders from buyers</p>
                                </div>
                                <div class="wd-page-actions">
                                    <button class="wd-btn wd-btn-primary" onclick="openAddPOModal()">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                                        <span data-i18n="sales.addPO">Add PO</span>
                                    </button>
                                </div>
                            </div>

                            <!-- Tabs -->
                            <div class="wd-tabs wd-px-6">
                                <button class="wd-tab active" onclick="filterPOByTab('active')" data-i18n="sales.activePO">Active POs</button>
                                <button class="wd-tab" onclick="filterPOByTab('cancelled')" data-i18n="sales.cancelledPO">Cancelled POs</button>
                            </div>

                            <!-- Filter Bar -->
                            <div class="wd-filter-bar">
                                <div class="wd-search">
                                    <svg class="wd-search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="11" cy="11" r="8"></circle>
                                        <path d="m21 21-4.3-4.3"></path>
                                    </svg>
                                    <input type="text" id="po-search" class="wd-input" placeholder="Search PO#, Buyer..." oninput="searchPO()">
                                </div>
                                <div></div>
                            </div>

                            <!-- Hidden filter value holder -->
                            <input type="hidden" id="po-status-filter" value="all">

                            <!-- PO Table -->
                            <div class="wd-section-x">
                                <table class="wd-table">
                                    <thead>
                                        <tr>
                                            <th class="sortable" onclick="sortPOTable('poNumber')">
                                                <span data-i18n="sales.poNumber">PO Number</span>
                                                <span class="sort-icon">â†•</span>
                                            </th>
                                            <th class="th-filter">
                                                <span data-i18n="sales.status">Status</span>
                                                <div class="wd-column-filter">
                                                    <button class="wd-filter-btn" onclick="toggleStatusFilter(event)">
                                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                                                        </svg>
                                                    </button>
                                                    <div class="wd-filter-dropdown" id="status-filter-dropdown">
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="status-filter" value="all" checked onchange="applyStatusFilter('all')">
                                                            <span>All</span>
                                                        </label>
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="status-filter" value="draft" onchange="applyStatusFilter('draft')">
                                                            <span>Draft</span>
                                                        </label>
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="status-filter" value="received" onchange="applyStatusFilter('received')">
                                                            <span>Received</span>
                                                        </label>
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="status-filter" value="confirmed" onchange="applyStatusFilter('confirmed')">
                                                            <span>Confirmed</span>
                                                        </label>
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="status-filter" value="cancelled" onchange="applyStatusFilter('cancelled')">
                                                            <span>Cancelled</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </th>
                                            <th class="sortable" onclick="sortPOTable('productName')">
                                                <span data-i18n="sales.productName">Product Name</span>
                                                <span class="sort-icon">â†•</span>
                                            </th>
                                            <th class="sortable" onclick="sortPOTable('totalAmount')">
                                                <span data-i18n="sales.totalAmount">Total Amount</span>
                                                <span class="sort-icon">â†•</span>
                                            </th>
                                            <th class="sortable" onclick="sortPOTable('buyer')">
                                                <span data-i18n="sales.buyer">Buyer</span>
                                                <span class="sort-icon">â†•</span>
                                            </th>
                                            <th data-i18n="sales.paymentTerms">Payment Terms</th>
                                            <th data-i18n="sales.incoterms">Incoterms</th>
                                            <th class="sortable" onclick="sortPOTable('modifiedDate')">
                                                <span data-i18n="sales.modifiedDate">Modified Date</span>
                                                <span class="sort-icon">â†•</span>
                                            </th>
                                            <th data-i18n="sales.createdBy">Created By</th>
                                        </tr>
                                    </thead>
                                <tbody id="po-list-tbody">
                                    <!-- Data loaded dynamically via API -->
                                </tbody>
                            </table>
                            </div>

                        </div>

                        <!-- PO Detail -->
                        <div class="dashboard-panel" id="panel-po-detail" style="display: none;">
                            <!-- Header -->
                            <div class="wd-page-header">
                                <div class="wd-page-header-content wd-flex wd-items-center wd-gap-3">
                                    <button class="wd-btn wd-btn-outline wd-btn-sm" onclick="backToPOList()">â†</button>
                                    <h2 class="wd-page-title" data-i18n="po.orderInfo">Order Information</h2>
                                </div>
                                <div class="wd-page-actions">
                                    <button class="wd-btn wd-btn-outline wd-btn-sm" onclick="downloadPO()" title="Download">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                            <polyline points="7 10 12 15 17 10"/>
                                            <line x1="12" y1="15" x2="12" y2="3"/>
                                        </svg>
                                    </button>
                                </div>
                            </div>

                            <div class="wd-section-padded">
                                <!-- PO Number & Status -->
                                <div class="wd-flex wd-items-center wd-justify-between wd-mb-6">
                                    <div class="wd-flex wd-items-center wd-gap-3">
                                        <span class="wd-text-lg wd-font-bold" id="po-detail-number">PO20260203048953</span>
                                        <span class="wd-badge wd-badge-info" id="po-detail-status">Shipping Requested</span>
                                        <span class="wd-text-muted" id="po-detail-date">2026.02.03 13:44</span>
                                    </div>
                                    <button class="wd-btn wd-btn-danger" onclick="cancelPO()" data-i18n="po.cancelOrder">Cancel Order</button>
                                </div>

                                <!-- Exporter Info -->
                                <div class="wd-card wd-mb-4">
                                    <div class="wd-card-header">
                                        <h3 class="wd-card-title" data-i18n="po.exporterInfo">Exporter Information</h3>
                                    </div>
                                    <div class="wd-card-body">
                                        <div class="wd-info-card">
                                            <div class="wd-info-avatar">
                                                <span>ðŸ¢</span>
                                            </div>
                                            <div class="wd-info-details">
                                                <div class="wd-info-name" id="po-exporter-name">DELIFRANCE</div>
                                                <div class="wd-info-contact">
                                                    <span class="wd-contact-item">
                                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                                                        <span id="po-exporter-contact">Anne, CHU</span>
                                                    </span>
                                                    <span class="wd-contact-item">
                                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                                                        <span id="po-exporter-email">anne.chu@delifrance.com</span>
                                                    </span>
                                                    <span class="wd-contact-item">
                                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
                                                        <span id="po-exporter-phone">+33 (0)6 73 18 08 52</span>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Importer Info -->
                                <div class="wd-card wd-mb-4">
                                    <div class="wd-card-header">
                                        <h3 class="wd-card-title" data-i18n="po.importerInfo">Importer Information</h3>
                                    </div>
                                    <div class="wd-card-body">
                                        <div class="wd-info-card">
                                            <div class="wd-info-avatar">
                                                <span>ðŸ¢</span>
                                            </div>
                                            <div class="wd-info-details">
                                                <div class="wd-info-name" id="po-importer-name">SELLER-NOTE.CO.,LTD</div>
                                                <div class="wd-info-contact">
                                                    <span class="wd-contact-item">
                                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                                                        <span id="po-importer-contact">jay</span>
                                                    </span>
                                                    <span class="wd-contact-item">
                                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                                                        <span id="po-importer-email">jay@seller-note.com</span>
                                                    </span>
                                                    <span class="wd-contact-item">
                                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
                                                        <span id="po-importer-phone">821026387225</span>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Trade Info -->
                                <div class="wd-card wd-mb-4">
                                    <div class="wd-card-header">
                                        <h3 class="wd-card-title" data-i18n="po.tradeInfo">Trade Information</h3>
                                    </div>
                                    <div class="wd-card-body">
                                        <div class="wd-info-grid">
                                            <div class="wd-info-item">
                                                <span class="wd-info-label" data-i18n="po.incoterms">Incoterms</span>
                                                <span class="wd-info-value" id="po-incoterms">FCA (Free Carrier)</span>
                                            </div>
                                            <div class="wd-info-item">
                                                <span class="wd-info-label" data-i18n="po.paymentTerms">Payment Terms</span>
                                                <span class="wd-info-value" id="po-payment-terms">T/T (Telegraphic Transfer)</span>
                                            </div>
                                            <div class="wd-info-item">
                                                <span class="wd-info-label" data-i18n="po.currency">Currency</span>
                                                <span class="wd-info-value" id="po-currency">EUR</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Items Info -->
                                <div class="wd-card wd-mb-4">
                                    <div class="wd-card-header">
                                        <h3 class="wd-card-title"><span data-i18n="po.itemsInfo">Items</span>(<span id="po-items-count">1</span>)</h3>
                                    </div>
                                    <div class="wd-card-body wd-p-0">
                                        <table class="wd-table">
                                            <thead>
                                                <tr>
                                                    <th data-i18n="po.itemName">Item Name</th>
                                                    <th class="wd-text-right" data-i18n="po.quantity">Quantity</th>
                                                    <th data-i18n="po.unit">Unit</th>
                                                    <th class="wd-text-right" data-i18n="po.unitPrice">Unit Price</th>
                                                    <th class="wd-text-right" data-i18n="po.subtotal">Subtotal</th>
                                                </tr>
                                            </thead>
                                            <tbody id="po-items-tbody">
                                                <tr>
                                                    <td>Frozen Butter Croissant Dough (24% Butter)</td>
                                                    <td class="wd-text-right">40</td>
                                                    <td>boxes</td>
                                                    <td class="wd-text-right">20.16</td>
                                                    <td class="wd-text-right">806.4</td>
                                                </tr>
                                            </tbody>
                                            <tfoot>
                                                <tr class="total-row">
                                                    <td colspan="2"><span data-i18n="po.totalQuantity">Total Quantity</span> <strong id="po-total-qty">40</strong></td>
                                                    <td colspan="3" class="wd-text-right"><span data-i18n="po.totalAmount">Total Amount</span> <strong><span id="po-total-currency">EUR</span> <span id="po-total-amount">806.4</span></strong></td>
                                                </tr>
                                            </tfoot>
                                        </table>
                                    </div>
                                </div>

                                <!-- Exporter Notes -->
                                <div class="wd-card wd-mb-4">
                                    <div class="wd-card-header">
                                        <h3 class="wd-card-title" data-i18n="po.exporterNotes">Exporter Notes</h3>
                                    </div>
                                    <div class="wd-card-body">
                                        <div class="wd-notes-box">
                                            <div class="wd-notes-label" data-i18n="po.specialNotes">Special Notes</div>
                                            <div class="wd-notes-content" id="po-notes">-</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Add PO Modal -->
                        <div class="wd-modal-overlay" id="add-po-modal" style="display: none;">
                            <div class="wd-modal wd-modal-xl">
                                <div class="wd-modal-header">
                                    <h3 class="wd-modal-title" id="add-po-modal-title" data-i18n="po.addPO">Add Purchase Order</h3>
                                    <button class="wd-modal-close" onclick="closeAddPOModal()">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                                    </button>
                                </div>
                                <div class="wd-modal-body" style="max-height: 70vh; overflow-y: auto;">
                                    <!-- Upload Section -->
                                    <div class="wd-form-section">
                                        <h4 class="wd-form-section-title">
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                                            <span data-i18n="po.uploadPODocument">Upload PO Document</span>
                                            <span class="wd-badge wd-badge-gray" style="margin-left: 8px;">Optional</span>
                                        </h4>
                                        <div class="wd-upload-area" id="po-upload-area" onclick="document.getElementById('po-file-input').click()">
                                            <input type="file" id="po-file-input" accept=".pdf,.png,.jpg,.jpeg,.doc,.docx,.xls,.xlsx" style="display: none;" onchange="handlePOFileUpload(event)">
                                            <div class="wd-upload-content">
                                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" style="color: var(--gray-400);">
                                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="12" y1="18" x2="12" y2="12"/><line x1="9" y1="15" x2="15" y2="15"/>
                                                </svg>
                                                <p class="wd-upload-text" data-i18n="po.dragDropPO">Drag & drop PO document or click to browse</p>
                                                <p class="wd-upload-hint">PDF, Image, Excel, Word (Max 20MB)</p>
                                            </div>
                                        </div>
                                        <div id="po-uploaded-file" class="wd-uploaded-file" style="display: none;">
                                            <div class="wd-file-info">
                                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                                                <span id="po-uploaded-filename">document.pdf</span>
                                            </div>
                                            <button type="button" class="wd-btn-icon" onclick="removePOFile()">
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                                            </button>
                                        </div>
                                        <p class="wd-text-muted wd-text-sm" style="margin-top: 8px;">
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle;"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
                                            Auto-parsing coming soon. Please fill in details manually below.
                                        </p>
                                    </div>

                                    <form id="add-po-form">
                                        <!-- Basic Info -->
                                        <div class="wd-form-section">
                                            <h4 class="wd-form-section-title" data-i18n="po.basicInfo">Basic Information</h4>
                                            <div class="wd-form-row">
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="po.poNumber">PO Number *</label>
                                                    <input type="text" class="wd-input" id="add-po-number" required placeholder="e.g. PO-2026-0001">
                                                </div>
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="po.orderDate">Order Date *</label>
                                                    <input type="date" class="wd-input" id="add-po-date" required>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Distributor/Buyer Info -->
                                        <div class="wd-form-section">
                                            <h4 class="wd-form-section-title" data-i18n="po.distributorInfo">Distributor (Buyer) Information</h4>
                                            <div class="wd-form-row">
                                                <div class="wd-form-group wd-flex-2">
                                                    <label class="wd-form-label" data-i18n="po.companyName">Company Name *</label>
                                                    <input type="text" class="wd-input" id="add-po-buyer-company" required placeholder="e.g. ABC Distribution Co.">
                                                </div>
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="po.contactPerson">Contact Person</label>
                                                    <input type="text" class="wd-input" id="add-po-buyer-contact" placeholder="e.g. John Smith">
                                                </div>
                                            </div>
                                            <div class="wd-form-row">
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="po.email">Email</label>
                                                    <input type="email" class="wd-input" id="add-po-buyer-email" placeholder="e.g. john@company.com">
                                                </div>
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="po.phone">Phone</label>
                                                    <input type="tel" class="wd-input" id="add-po-buyer-phone" placeholder="e.g. +1 234 567 8900">
                                                </div>
                                            </div>
                                            <div class="wd-form-group">
                                                <label class="wd-form-label" data-i18n="po.address">Address</label>
                                                <textarea class="wd-textarea" id="add-po-buyer-address" rows="2" placeholder="Full shipping address..."></textarea>
                                            </div>
                                        </div>

                                        <!-- Trade Terms -->
                                        <div class="wd-form-section">
                                            <h4 class="wd-form-section-title" data-i18n="po.tradeTerms">Trade Terms</h4>
                                            <div class="wd-form-row">
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="po.currency">Currency *</label>
                                                    <select class="wd-select" id="add-po-currency" required onchange="updatePOCurrency()">
                                                        <option value="USD">USD - US Dollar</option>
                                                        <option value="EUR">EUR - Euro</option>
                                                        <option value="KRW">KRW - Korean Won</option>
                                                        <option value="JPY">JPY - Japanese Yen</option>
                                                        <option value="CNY">CNY - Chinese Yuan</option>
                                                        <option value="GBP">GBP - British Pound</option>
                                                    </select>
                                                </div>
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="po.incoterms">Incoterms *</label>
                                                    <select class="wd-select" id="add-po-incoterms" required>
                                                        <option value="EXW">EXW - Ex Works</option>
                                                        <option value="FCA">FCA - Free Carrier</option>
                                                        <option value="FAS">FAS - Free Alongside Ship</option>
                                                        <option value="FOB">FOB - Free on Board</option>
                                                        <option value="CFR">CFR - Cost and Freight</option>
                                                        <option value="CIF">CIF - Cost, Insurance, Freight</option>
                                                        <option value="DAP">DAP - Delivered at Place</option>
                                                        <option value="DDP">DDP - Delivered Duty Paid</option>
                                                    </select>
                                                </div>
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="po.paymentTerms">Payment Terms *</label>
                                                    <select class="wd-select" id="add-po-payment-terms" required>
                                                        <option value="TT">T/T (Telegraphic Transfer)</option>
                                                        <option value="LC">L/C (Letter of Credit)</option>
                                                        <option value="DP">D/P (Documents against Payment)</option>
                                                        <option value="DA">D/A (Documents against Acceptance)</option>
                                                        <option value="CAD">CAD (Cash against Documents)</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Items -->
                                        <div class="wd-form-section">
                                            <h4 class="wd-form-section-title">
                                                <span data-i18n="po.orderItems">Order Items</span>
                                                <button type="button" class="wd-btn wd-btn-outline wd-btn-sm" onclick="addPOItemRow()" style="margin-left: auto;">
                                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                                                    <span data-i18n="po.addItem">Add Item</span>
                                                </button>
                                            </h4>
                                            <div class="wd-table-container">
                                                <table class="wd-table wd-table-sm" id="add-po-items-table">
                                                    <thead>
                                                        <tr>
                                                            <th style="width: 35%;" data-i18n="po.productName">Product Name *</th>
                                                            <th style="width: 12%;" data-i18n="po.quantity">Qty *</th>
                                                            <th style="width: 12%;" data-i18n="po.unit">Unit</th>
                                                            <th style="width: 15%;" data-i18n="po.unitPrice">Unit Price *</th>
                                                            <th style="width: 15%;" data-i18n="po.subtotal">Subtotal</th>
                                                            <th style="width: 50px;"></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="add-po-items-tbody">
                                                        <tr data-row="0">
                                                            <td><input type="text" class="wd-input wd-input-sm po-item-name" required placeholder="Product name"></td>
                                                            <td><input type="number" class="wd-input wd-input-sm po-item-qty" required min="1" value="1" onchange="calculatePOItemSubtotal(0)"></td>
                                                            <td>
                                                                <select class="wd-select wd-select-sm po-item-unit">
                                                                    <option value="pcs">pcs</option>
                                                                    <option value="boxes">boxes</option>
                                                                    <option value="cases">cases</option>
                                                                    <option value="pallets">pallets</option>
                                                                    <option value="kg">kg</option>
                                                                    <option value="lbs">lbs</option>
                                                                    <option value="liters">liters</option>
                                                                </select>
                                                            </td>
                                                            <td><input type="number" class="wd-input wd-input-sm po-item-price" required min="0" step="0.01" value="0" onchange="calculatePOItemSubtotal(0)"></td>
                                                            <td class="po-item-subtotal wd-text-right wd-text-bold">0.00</td>
                                                            <td>
                                                                <button type="button" class="wd-btn-icon wd-btn-icon-danger" onclick="removePOItemRow(0)" title="Remove">
                                                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                                                                </button>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                    <tfoot>
                                                        <tr>
                                                            <td colspan="4" class="wd-text-right wd-text-bold" data-i18n="po.totalAmount">Total Amount</td>
                                                            <td class="wd-text-right wd-text-bold">
                                                                <span id="add-po-currency-symbol">USD</span>
                                                                <span id="add-po-total-amount">0.00</span>
                                                            </td>
                                                            <td></td>
                                                        </tr>
                                                    </tfoot>
                                                </table>
                                            </div>
                                        </div>

                                        <!-- Notes -->
                                        <div class="wd-form-section">
                                            <h4 class="wd-form-section-title" data-i18n="po.notes">Notes</h4>
                                            <div class="wd-form-group">
                                                <textarea class="wd-textarea" id="add-po-notes" rows="3" placeholder="Special instructions, delivery notes, etc..."></textarea>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="wd-modal-footer">
                                    <button class="wd-btn wd-btn-outline" onclick="closeAddPOModal()" data-i18n="common.cancel">Cancel</button>
                                    <button class="wd-btn wd-btn-secondary" onclick="savePOAsDraft()" data-i18n="po.saveAsDraft">Save as Draft</button>
                                    <button class="wd-btn wd-btn-primary" onclick="savePO()" data-i18n="po.savePO">Register PO</button>
                                </div>
                            </div>
                        </div>

                        <!-- INV Management -->
                        <div class="dashboard-panel" id="panel-inv-management">
                            <!-- Page Header -->
                            <div class="wd-page-header">
                                <div class="wd-page-header-content">
                                    <h2 class="wd-page-title" data-i18n="inv.title">INV Management</h2>
                                    <p class="wd-page-subtitle" data-i18n="inv.subtitle">Create and manage Invoices based on Purchase Orders</p>
                                </div>
                                <div class="wd-page-actions">
                                    <button class="wd-btn wd-btn-primary" onclick="openINVModal()">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                                        <span data-i18n="inv.addINV">Add INV</span>
                                    </button>
                                </div>
                            </div>

                            <!-- Tabs -->
                            <div class="wd-tabs wd-px-6">
                                <button class="wd-tab active" onclick="filterINVByTab('active')" data-i18n="inv.activeINV">Active INVs</button>
                                <button class="wd-tab" onclick="filterINVByTab('cancelled')" data-i18n="inv.cancelledINV">Cancelled INVs</button>
                            </div>

                            <!-- Filter Bar -->
                            <div class="wd-filter-bar">
                                <div class="wd-search">
                                    <svg class="wd-search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="11" cy="11" r="8"></circle>
                                        <path d="m21 21-4.3-4.3"></path>
                                    </svg>
                                    <input type="text" id="inv-search" class="wd-input" placeholder="Search INV#, PO#, Buyer..." oninput="filterINVList()">
                                </div>
                                <div></div>
                            </div>

                            <!-- Hidden filter value holder -->
                            <input type="hidden" id="inv-status-filter" value="all">
                            <input type="hidden" id="inv-tab-filter" value="active">

                            <!-- INV Table -->
                            <div class="wd-section-x">
                                <table class="wd-table">
                                    <thead>
                                        <tr>
                                            <th class="sortable" onclick="sortINVTable('invNumber')">
                                                <span data-i18n="inv.invNumber">INV Number</span>
                                                <span class="sort-icon">â†•</span>
                                            </th>
                                            <th class="th-filter">
                                                <span data-i18n="inv.status">Status</span>
                                                <div class="wd-column-filter">
                                                    <button class="wd-filter-btn" onclick="toggleINVStatusFilter(event)">
                                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                                                        </svg>
                                                    </button>
                                                    <div class="wd-filter-dropdown" id="inv-status-filter-dropdown">
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="inv-status-filter" value="all" checked onchange="applyINVStatusFilter('all')">
                                                            <span>All</span>
                                                        </label>
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="inv-status-filter" value="draft" onchange="applyINVStatusFilter('draft')">
                                                            <span>Draft</span>
                                                        </label>
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="inv-status-filter" value="sent" onchange="applyINVStatusFilter('sent')">
                                                            <span>Sent</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </th>
                                            <th class="th-filter">
                                                <span data-i18n="inv.payment">Payment</span>
                                                <div class="wd-column-filter">
                                                    <button class="wd-filter-btn" onclick="toggleINVPaymentFilter(event)">
                                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                                                        </svg>
                                                    </button>
                                                    <div class="wd-filter-dropdown" id="inv-payment-filter-dropdown">
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="inv-payment-filter" value="all" checked onchange="applyINVPaymentFilter('all')">
                                                            <span>All</span>
                                                        </label>
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="inv-payment-filter" value="paid" onchange="applyINVPaymentFilter('paid')">
                                                            <span>Paid</span>
                                                        </label>
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="inv-payment-filter" value="unpaid" onchange="applyINVPaymentFilter('unpaid')">
                                                            <span>Unpaid</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </th>
                                            <th data-i18n="inv.poReference">PO Reference</th>
                                            <th class="sortable" onclick="sortINVTable('buyer')">
                                                <span data-i18n="inv.buyer">Buyer</span>
                                                <span class="sort-icon">â†•</span>
                                            </th>
                                            <th class="sortable" onclick="sortINVTable('totalAmount')">
                                                <span data-i18n="inv.totalAmount">Total Amount</span>
                                                <span class="sort-icon">â†•</span>
                                            </th>
                                            <th class="sortable" onclick="sortINVTable('issueDate')">
                                                <span data-i18n="inv.issueDate">Issue Date</span>
                                                <span class="sort-icon">â†•</span>
                                            </th>
                                            <th data-i18n="sales.createdBy">Created By</th>
                                        </tr>
                                    </thead>
                                    <tbody id="inv-table-body">
                                        <!-- Data loaded dynamically via API -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- INV Create/Edit Modal (Legacy - now using dedicated page) -->
                        <div class="wd-modal-overlay" id="inv-modal" style="display: none;">
                            <div class="wd-modal wd-modal-xl">
                                <div class="wd-modal-header">
                                    <h3 class="wd-modal-title" id="inv-modal-title" data-i18n="inv.addINV">Add Invoice</h3>
                                    <button class="wd-modal-close" onclick="closeINVModal()">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                                    </button>
                                </div>
                                <div class="wd-modal-body" style="max-height: 70vh; overflow-y: auto;">
                                    <form id="inv-form">
                                        <!-- Source Selection: PO or New -->
                                        <div class="wd-form-section">
                                            <h4 class="wd-form-section-title">
                                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                                                <span data-i18n="inv.invSource">INV Source</span>
                                            </h4>
                                            <div class="wd-radio-group" style="display: flex; gap: 24px; margin-bottom: 16px;">
                                                <label class="wd-radio-label">
                                                    <input type="radio" name="inv-source" value="po" checked onchange="toggleINVSource('po')">
                                                    <span class="wd-radio-text" data-i18n="inv.fromPO">From Purchase Order</span>
                                                </label>
                                                <label class="wd-radio-label">
                                                    <input type="radio" name="inv-source" value="new" onchange="toggleINVSource('new')">
                                                    <span class="wd-radio-text" data-i18n="inv.newINV">New INV (Manual)</span>
                                                </label>
                                            </div>

                                            <!-- PO Selection (when source=po) -->
                                            <div id="inv-po-selection" class="wd-form-group">
                                                <label class="wd-form-label" data-i18n="inv.selectPO">Select Purchase Order</label>
                                                <select class="wd-select" id="inv-po-select" onchange="loadPOForINV()">
                                                    <option value="">Select a PO to load...</option>
                                                    <option value="PO-2024-0156" data-buyer="ACC-001">PO-2024-0156 - ABC Distribution (Feb 01, 2024)</option>
                                                    <option value="PO-2024-0142" data-buyer="ACC-002">PO-2024-0142 - XYZ Foods Ltd (Jan 25, 2024)</option>
                                                    <option value="PO-2024-0138" data-buyer="ACC-003">PO-2024-0138 - Global Trade Co (Jan 18, 2024)</option>
                                                </select>
                                            </div>
                                        </div>

                                        <!-- Buyer Selection -->
                                        <div class="wd-form-section" id="inv-buyer-section">
                                            <h4 class="wd-form-section-title">
                                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                                                <span data-i18n="inv.buyerInfo">Buyer Information</span>
                                            </h4>
                                            <div class="wd-form-row">
                                                <div class="wd-form-group wd-flex-2">
                                                    <label class="wd-form-label" data-i18n="inv.selectBuyer">Select Buyer *</label>
                                                    <select class="wd-select" id="inv-buyer-select" required onchange="loadBuyerForINV()">
                                                        <option value="">Select a buyer...</option>
                                                    </select>
                                                </div>
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="inv.invDate">INV Date</label>
                                                    <input type="date" class="wd-input" id="inv-date">
                                                </div>
                                            </div>
                                            <div class="wd-buyer-info-card" id="inv-buyer-info-card" style="display: none;">
                                                <div class="wd-info-row">
                                                    <span class="wd-info-label">Company:</span>
                                                    <span class="wd-info-value" id="inv-buyer-company-display">-</span>
                                                </div>
                                                <div class="wd-info-row">
                                                    <span class="wd-info-label">Country:</span>
                                                    <span class="wd-info-value" id="inv-buyer-country-display">-</span>
                                                </div>
                                                <div class="wd-info-row">
                                                    <span class="wd-info-label">Available Credit:</span>
                                                    <span class="wd-info-value wd-text-success" id="inv-buyer-credit-display">$0.00</span>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Order Items -->
                                        <div class="wd-form-section" id="inv-items-section">
                                            <h4 class="wd-form-section-title">
                                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>
                                                <span data-i18n="inv.orderItems">Order Items</span>
                                                <span class="wd-badge wd-badge-info" style="margin-left: 8px; font-weight: normal;">Only completed products</span>
                                            </h4>

                                            <!-- Product Search/Add (Only Completed Products) -->
                                            <div class="wd-product-add-row" style="display: flex; gap: 12px; margin-bottom: 16px;">
                                                <div class="wd-form-group" style="flex: 3; margin-bottom: 0;">
                                                    <select class="wd-select" id="inv-product-select" onchange="previewProductToAdd()">
                                                        <option value="">Select a completed product to add...</option>
                                                        <!-- Only COMPLETED status products are shown -->
                                                        <option value="PROD-001" data-name="Extra Virgin Olive Oil 500ml" data-price="25.00" data-unit="bottles">Extra Virgin Olive Oil 500ml (PROD-001)</option>
                                                        <option value="PROD-002" data-name="Aged Parmesan 24 months 1kg" data-price="65.00" data-unit="pcs">Aged Parmesan 24 months 1kg (PROD-002)</option>
                                                        <option value="PROD-003" data-name="Organic Honey 350g" data-price="18.00" data-unit="jars">Organic Honey 350g (PROD-003)</option>
                                                        <option value="PROD-004" data-name="Balsamic Vinegar 250ml" data-price="32.00" data-unit="bottles">Balsamic Vinegar 250ml (PROD-004)</option>
                                                        <option value="PROD-005" data-name="Truffle Oil 100ml" data-price="45.00" data-unit="bottles">Truffle Oil 100ml (PROD-005)</option>
                                                        <option value="PROD-006" data-name="Dried Pasta 500g" data-price="12.00" data-unit="boxes">Dried Pasta 500g (PROD-006)</option>
                                                    </select>
                                                </div>
                                                <button type="button" class="wd-btn wd-btn-primary" onclick="addProductToINV()" style="white-space: nowrap;">
                                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                                                    <span data-i18n="inv.addProduct">Add Product</span>
                                                </button>
                                            </div>
                                            <p class="wd-text-muted wd-text-sm" style="margin-bottom: 16px;">
                                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle;"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
                                                Only products with "Completed" status can be added. <a href="#" class="wd-link" onclick="showSection('product-list'); closeINVModal(); return false;">Manage products â†’</a>
                                            </p>

                                            <!-- Items Table -->
                                            <div class="wd-table-container">
                                                <table class="wd-table wd-table-sm" id="inv-items-table">
                                                    <thead>
                                                        <tr>
                                                            <th style="width: 35%;" data-i18n="inv.product">Product</th>
                                                            <th style="width: 12%;" data-i18n="inv.quantity">Qty</th>
                                                            <th style="width: 12%;" data-i18n="inv.unit">Unit</th>
                                                            <th style="width: 15%;" data-i18n="inv.unitPrice">Unit Price</th>
                                                            <th style="width: 15%;" data-i18n="inv.amount">Amount</th>
                                                            <th style="width: 50px;"></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="inv-items-tbody">
                                                        <tr class="wd-empty-row">
                                                            <td colspan="6" class="wd-text-center wd-text-muted" style="padding: 24px;">
                                                                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" style="margin-bottom: 8px; opacity: 0.5;"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/></svg>
                                                                <div data-i18n="inv.noItemsYet">No items added yet. Select a PO or add products above.</div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>

                                        <!-- Credit Application (Buyer-based) -->
                                        <div class="wd-form-section" id="inv-credit-section" style="display: none;">
                                            <h4 class="wd-form-section-title">
                                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>
                                                <span data-i18n="inv.applyCredit">Apply Credit</span>
                                                <span class="wd-badge wd-badge-info" id="available-credit-badge">$0.00 available</span>
                                            </h4>
                                            <p class="wd-text-muted wd-text-sm wd-mb-3" data-i18n="inv.creditBuyerNote">Available credits from this buyer's previous invoices</p>
                                            <div class="wd-credit-list" id="inv-available-credits">
                                                <!-- Credits will be loaded based on Buyer -->
                                            </div>
                                        </div>

                                        <!-- INV Summary -->
                                        <div class="wd-form-section" id="inv-summary-section">
                                            <h4 class="wd-form-section-title" data-i18n="inv.summary">Summary</h4>
                                            <div class="wd-summary-box">
                                                <div class="wd-summary-row">
                                                    <span data-i18n="inv.subtotal">Subtotal</span>
                                                    <span id="inv-subtotal">$0.00</span>
                                                </div>
                                                <div class="wd-summary-row wd-text-success">
                                                    <span data-i18n="inv.creditDiscount">Credit Discount</span>
                                                    <span id="inv-credit-discount">-$0.00</span>
                                                </div>
                                                <div class="wd-summary-row wd-summary-total">
                                                    <span data-i18n="inv.totalAmount">Total Amount</span>
                                                    <span id="inv-total">$0.00</span>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Trade Terms -->
                                        <div class="wd-form-section" id="inv-terms-section">
                                            <h4 class="wd-form-section-title">
                                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>
                                                <span data-i18n="inv.tradeTerms">Trade Terms</span>
                                            </h4>
                                            <div class="wd-form-row">
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="inv.currency">Currency</label>
                                                    <select class="wd-select" id="inv-currency" onchange="updateINVCurrency()">
                                                        <option value="USD">USD - US Dollar</option>
                                                        <option value="EUR">EUR - Euro</option>
                                                        <option value="KRW">KRW - Korean Won</option>
                                                        <option value="JPY">JPY - Japanese Yen</option>
                                                    </select>
                                                </div>
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="inv.incoterms">Incoterms</label>
                                                    <select class="wd-select" id="inv-incoterms">
                                                        <option value="FOB">FOB - Free on Board</option>
                                                        <option value="CIF">CIF - Cost, Insurance, Freight</option>
                                                        <option value="EXW">EXW - Ex Works</option>
                                                        <option value="DDP">DDP - Delivered Duty Paid</option>
                                                    </select>
                                                </div>
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="inv.paymentMethod">Payment Terms</label>
                                                    <select class="wd-select" id="inv-payment-method">
                                                        <option value="tt30">T/T 30% Advance, 70% Before Shipment</option>
                                                        <option value="tt50">T/T 50% Advance, 50% Before Shipment</option>
                                                        <option value="tt100">T/T 100% Advance</option>
                                                        <option value="lc">L/C at Sight</option>
                                                        <option value="dp">D/P at Sight</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="wd-form-row">
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="inv.validUntil">Valid Until</label>
                                                    <input type="date" class="wd-input" id="inv-valid-until">
                                                </div>
                                                <div class="wd-form-group wd-flex-2">
                                                    <label class="wd-form-label" data-i18n="inv.remarks">Remarks</label>
                                                    <input type="text" class="wd-input" id="inv-remarks" placeholder="Additional notes for the buyer...">
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="wd-modal-footer">
                                    <button class="wd-btn wd-btn-outline" onclick="closeINVModal()" data-i18n="common.cancel">Cancel</button>
                                    <button class="wd-btn wd-btn-secondary" onclick="saveAsDraft()" data-i18n="inv.saveAsDraft">Save as Draft</button>
                                    <button class="wd-btn wd-btn-primary" onclick="createAndSendINV()" data-i18n="inv.createAndSend">Create & Send INV</button>
                                </div>
                            </div>
                        </div>

                        <!-- Credit Management -->
                        <div class="dashboard-panel" id="panel-credit-management">
                            <!-- Page Header -->
                            <div class="wd-page-header">
                                <div class="wd-page-header-content">
                                    <h2 class="wd-page-title" data-i18n="credit.title">Credit Management</h2>
                                    <p class="wd-page-subtitle" data-i18n="credit.subtitle">Manage product claims and credits for invoice deductions</p>
                                </div>
                                <div class="wd-page-actions">
                                    <button class="wd-btn wd-btn-primary" onclick="openCreditPage()">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                                        <span data-i18n="credit.addCredit">Add Credit</span>
                                    </button>
                                </div>
                            </div>

                            <!-- Tabs -->
                            <div class="wd-tabs wd-px-6">
                                <button class="wd-tab active" onclick="filterCreditByTab('active')" data-i18n="credit.activeCredits">Active Credits</button>
                                <button class="wd-tab" onclick="filterCreditByTab('cancelled')" data-i18n="credit.cancelledCredits">Cancelled Credits</button>
                            </div>

                            <!-- Filter Bar -->
                            <div class="wd-filter-bar">
                                <div class="wd-search">
                                    <svg class="wd-search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="11" cy="11" r="8"></circle>
                                        <path d="m21 21-4.3-4.3"></path>
                                    </svg>
                                    <input type="text" id="credit-search" class="wd-input" placeholder="Search Credit#, Invoice, Buyer..." oninput="filterCredits()">
                                </div>
                                <div></div>
                            </div>

                            <!-- Hidden filter value holders -->
                            <input type="hidden" id="credit-status-filter" value="all">
                            <input type="hidden" id="credit-tab-filter" value="active">

                            <!-- Credit Table -->
                            <div class="wd-section-x">
                                <table class="wd-table">
                                    <thead>
                                        <tr>
                                            <th class="sortable" onclick="sortCreditTable('creditId')">
                                                <span data-i18n="credit.creditId">Credit ID</span>
                                                <span class="sort-icon">â†•</span>
                                            </th>
                                            <th class="th-filter">
                                                <span data-i18n="credit.status">Status</span>
                                                <div class="wd-column-filter">
                                                    <button class="wd-filter-btn" onclick="toggleCreditStatusFilter(event)">
                                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                                                        </svg>
                                                    </button>
                                                    <div class="wd-filter-dropdown" id="credit-status-filter-dropdown">
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="credit-status-filter" value="all" checked onchange="applyCreditStatusFilter('all')">
                                                            <span>All</span>
                                                        </label>
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="credit-status-filter" value="draft" onchange="applyCreditStatusFilter('draft')">
                                                            <span>Draft</span>
                                                        </label>
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="credit-status-filter" value="approved" onchange="applyCreditStatusFilter('approved')">
                                                            <span>Approved</span>
                                                        </label>
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="credit-status-filter" value="used" onchange="applyCreditStatusFilter('used')">
                                                            <span>Used</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </th>
                                            <th data-i18n="credit.invoiceNumber">Invoice/INV</th>
                                            <th class="sortable" onclick="sortCreditTable('buyer')">
                                                <span data-i18n="credit.buyer">Buyer</span>
                                                <span class="sort-icon">â†•</span>
                                            </th>
                                            <th data-i18n="credit.product">Product</th>
                                            <th data-i18n="credit.claimReason">Claim Reason</th>
                                            <th class="sortable" onclick="sortCreditTable('amount')">
                                                <span data-i18n="credit.amount">Amount</span>
                                                <span class="sort-icon">â†•</span>
                                            </th>
                                            <th class="sortable" onclick="sortCreditTable('createdDate')">
                                                <span data-i18n="credit.createdDate">Created Date</span>
                                                <span class="sort-icon">â†•</span>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="credit-table-body">
                                        <!-- Data loaded dynamically via API -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Credit Modal -->
                        <div class="wd-modal-overlay" id="credit-modal" style="display: none;">
                            <div class="wd-modal wd-modal-md">
                                <div class="wd-modal-header">
                                    <h3 class="wd-modal-title" id="credit-modal-title" data-i18n="credit.newCredit">New Credit</h3>
                                    <button class="wd-modal-close" onclick="closeCreditModal()">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                                    </button>
                                </div>
                                <div class="wd-modal-body">
                                    <form id="credit-form">
                                        <div class="wd-form-group">
                                            <label class="wd-form-label" data-i18n="credit.selectInvoice">Select Invoice *</label>
                                            <select class="wd-select" id="credit-invoice-select" required onchange="loadInvoiceProducts()">
                                                <option value="">Select an Invoice...</option>
                                                <option value="INV-2024-0089" data-buyer="ABC Distribution">INV-2024-0089 - ABC Distribution (Feb 01, 2024)</option>
                                                <option value="INV-2024-0088" data-buyer="XYZ Foods Ltd">INV-2024-0088 - XYZ Foods Ltd (Jan 25, 2024)</option>
                                                <option value="INV-2024-0087" data-buyer="Global Trade Co">INV-2024-0087 - Global Trade Co (Jan 18, 2024)</option>
                                            </select>
                                        </div>
                                        <div class="wd-form-group">
                                            <label class="wd-form-label" data-i18n="credit.selectProduct">Select Product *</label>
                                            <select class="wd-select" id="credit-product-select" required>
                                                <option value="">Select PO first...</option>
                                            </select>
                                        </div>
                                        <div class="wd-form-row">
                                            <div class="wd-form-group">
                                                <label class="wd-form-label" data-i18n="credit.claimReason">Claim Reason *</label>
                                                <select class="wd-select" id="credit-reason" required>
                                                    <option value="">Select reason...</option>
                                                    <option value="damaged" data-i18n="credit.reasonDamaged">Damaged packaging</option>
                                                    <option value="quality" data-i18n="credit.reasonQuality">Quality issue</option>
                                                    <option value="short" data-i18n="credit.reasonShort">Short shipment</option>
                                                    <option value="wrong" data-i18n="credit.reasonWrong">Wrong product</option>
                                                    <option value="expired" data-i18n="credit.reasonExpired">Expired/Near expiry</option>
                                                    <option value="other" data-i18n="credit.reasonOther">Other</option>
                                                </select>
                                            </div>
                                            <div class="wd-form-group">
                                                <label class="wd-form-label" data-i18n="credit.affectedQty">Affected Quantity *</label>
                                                <input type="number" class="wd-input" id="credit-qty" min="1" required placeholder="Enter quantity">
                                            </div>
                                        </div>
                                        <div class="wd-form-group">
                                            <label class="wd-form-label" data-i18n="credit.creditAmount">Credit Amount (USD) *</label>
                                            <input type="number" class="wd-input" id="credit-amount" min="0" step="0.01" required placeholder="0.00">
                                        </div>
                                        <div class="wd-form-group">
                                            <label class="wd-form-label" data-i18n="credit.description">Description</label>
                                            <textarea class="wd-textarea" id="credit-description" rows="3" placeholder="Provide additional details about the claim..."></textarea>
                                        </div>
                                        <div class="wd-form-group">
                                            <label class="wd-form-label" data-i18n="credit.attachments">Attachments (Photos/Documents)</label>
                                            <div class="wd-file-upload" onclick="document.getElementById('credit-files').click()">
                                                <input type="file" id="credit-files" multiple accept="image/*,.pdf" style="display:none" onchange="handleCreditFiles(event)">
                                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                                                <span data-i18n="credit.dropFiles">Click or drop files here</span>
                                            </div>
                                            <div id="credit-file-list" class="wd-file-list"></div>
                                        </div>
                                    </form>
                                </div>
                                <div class="wd-modal-footer">
                                    <button class="wd-btn wd-btn-outline" onclick="closeCreditModal()" data-i18n="common.cancel">Cancel</button>
                                    <button class="wd-btn wd-btn-secondary" onclick="saveCreditAsDraft()" data-i18n="credit.saveAsDraft">Save as Draft</button>
                                    <button class="wd-btn wd-btn-primary" onclick="saveCredit()" data-i18n="credit.submitCredit">Submit Credit</button>
                                </div>
                            </div>
                        </div>

                        <!-- Account Management (ê±°ëž˜ì²˜ ê´€ë¦¬) -->
                        <div class="dashboard-panel" id="panel-accounts">
                            <!-- Page Header -->
                            <div class="wd-page-header">
                                <div class="wd-page-header-content">
                                    <h2 class="wd-page-title" data-i18n="accounts.title">Account Management</h2>
                                    <p class="wd-page-subtitle" data-i18n="accounts.subtitle">View buyer accounts, sales performance and transaction history</p>
                                </div>
                                <div class="wd-page-actions">
                                    <button class="wd-btn wd-btn-primary" onclick="openAccountModal()">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                                        <span data-i18n="accounts.addAccount">Add Account</span>
                                    </button>
                                </div>
                            </div>

                            <!-- Filter Bar -->
                            <div class="wd-filter-bar">
                                <div class="wd-search">
                                    <svg class="wd-search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="11" cy="11" r="8"></circle>
                                        <path d="m21 21-4.3-4.3"></path>
                                    </svg>
                                    <input type="text" id="account-search" class="wd-input" placeholder="Search company, contact..." oninput="filterAccounts()">
                                </div>
                                <div></div>
                            </div>

                            <!-- Hidden filter value holder -->
                            <input type="hidden" id="account-pi-status-filter" value="all">

                            <!-- Account Table with PI Status and Monthly Sales -->
                            <div class="wd-section-x">
                                <table class="wd-table">
                                    <thead>
                                        <tr>
                                            <th class="sortable" onclick="sortAccountTable('company')">
                                                <span data-i18n="accounts.companyName">Company Name</span>
                                                <span class="sort-icon">â†•</span>
                                            </th>
                                            <th data-i18n="accounts.country">Country</th>
                                            <th class="th-filter">
                                                <span data-i18n="accounts.invoiceStatus">Invoice Status</span>
                                                <div class="wd-column-filter">
                                                    <button class="wd-filter-btn" onclick="toggleAccountPIFilter(event)">
                                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                                                        </svg>
                                                    </button>
                                                    <div class="wd-filter-dropdown" id="account-pi-filter-dropdown">
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="account-pi-filter" value="all" checked onchange="applyAccountPIFilter('all')">
                                                            <span>All</span>
                                                        </label>
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="account-pi-filter" value="completed" onchange="applyAccountPIFilter('completed')">
                                                            <span>Completed</span>
                                                        </label>
                                                        <label class="wd-filter-option">
                                                            <input type="radio" name="account-pi-filter" value="in-progress" onchange="applyAccountPIFilter('in-progress')">
                                                            <span>In Progress</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </th>
                                            <th class="sortable" onclick="sortAccountTable('monthlySales')">
                                                <span data-i18n="accounts.monthlySales">Monthly Sales</span>
                                                <span class="sort-icon">â†•</span>
                                            </th>
                                            <th class="sortable" onclick="sortAccountTable('totalSales')">
                                                <span data-i18n="accounts.totalSales">Total Sales</span>
                                                <span class="sort-icon">â†•</span>
                                            </th>
                                            <th data-i18n="accounts.topProducts">Top Products</th>
                                            <th data-i18n="accounts.lastOrder">Last Invoice</th>
                                        </tr>
                                    </thead>
                                    <tbody id="accounts-table-body">
                                        <!-- Data loaded dynamically via API -->
                                    </tbody>
                                </table>
                            </div>

                            <!-- Account Detail Drawer Overlay -->
                            <div class="wd-drawer-overlay" id="account-drawer-overlay" onclick="closeAccountDrawer()"></div>

                            <!-- Account Detail Drawer (shows when clicking a row) -->
                            <div class="wd-drawer wd-drawer-lg" id="account-detail-drawer">
                                <div class="wd-drawer-header">
                                    <div class="wd-drawer-header-content">
                                        <h3 class="wd-drawer-title" id="account-drawer-title">ABC Distribution</h3>
                                        <span class="wd-drawer-subtitle" id="account-drawer-subtitle">ðŸ‡°ðŸ‡· South Korea</span>
                                    </div>
                                    <button class="wd-drawer-close" onclick="closeAccountDrawer()">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                                    </button>
                                </div>
                                <div class="wd-drawer-body">
                                    <!-- Basic Account Info -->
                                    <div class="wd-drawer-section">
                                        <h4 class="wd-drawer-section-title">Basic Information</h4>
                                        <div class="wd-info-grid" id="account-drawer-info">
                                            <div class="wd-info-item">
                                                <span class="wd-info-label">Contact Person</span>
                                                <span class="wd-info-value">Kim Min-jun</span>
                                            </div>
                                            <div class="wd-info-item">
                                                <span class="wd-info-label">Email</span>
                                                <span class="wd-info-value">kim@abcdist.co.kr</span>
                                            </div>
                                            <div class="wd-info-item">
                                                <span class="wd-info-label">Trade Terms</span>
                                                <span class="wd-info-value">CIF / T/T 30%</span>
                                            </div>
                                            <div class="wd-info-item">
                                                <span class="wd-info-label">Total Completed Sales</span>
                                                <span class="wd-info-value wd-text-bold">$45,600</span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Year/Month Sales Statistics (Completed PI Only) -->
                                    <div class="wd-drawer-section">
                                        <div class="wd-section-header">
                                            <h4 class="wd-drawer-section-title">
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
                                                Monthly Sales (Completed INV)
                                            </h4>
                                            <select class="wd-select wd-select-sm" id="account-sales-year" onchange="changeAccountSalesYear()" style="width: 100px;">
                                                <option value="2026" selected>2026</option>
                                                <option value="2025">2025</option>
                                                <option value="2024">2024</option>
                                                <option value="2023">2023</option>
                                            </select>
                                        </div>
                                        <p class="wd-text-muted wd-text-sm" style="margin-bottom: 12px;">Hover over amount to see product breakdown</p>

                                        <!-- Monthly Sales Grid -->
                                        <div class="wd-monthly-sales-grid" id="account-monthly-sales">
                                            <!-- Q1 -->
                                            <div class="wd-sales-cell wd-sales-cell-hoverable" data-month="2026-01" onmouseenter="showProductTooltip(event, '2026-01')" onmouseleave="hideProductTooltip()">
                                                <span class="wd-sales-month">Jan</span>
                                                <span class="wd-sales-amount">$9,700</span>
                                                <span class="wd-sales-count">3 INV</span>
                                            </div>
                                            <div class="wd-sales-cell wd-sales-cell-hoverable wd-sales-cell-current" data-month="2026-02" onmouseenter="showProductTooltip(event, '2026-02')" onmouseleave="hideProductTooltip()">
                                                <span class="wd-sales-month">Feb</span>
                                                <span class="wd-sales-amount">$5,420</span>
                                                <span class="wd-sales-count">2 INV</span>
                                            </div>
                                            <div class="wd-sales-cell wd-sales-cell-empty" data-month="2026-03">
                                                <span class="wd-sales-month">Mar</span>
                                                <span class="wd-sales-amount">-</span>
                                            </div>
                                            <!-- Q2 -->
                                            <div class="wd-sales-cell wd-sales-cell-empty" data-month="2026-04">
                                                <span class="wd-sales-month">Apr</span>
                                                <span class="wd-sales-amount">-</span>
                                            </div>
                                            <div class="wd-sales-cell wd-sales-cell-empty" data-month="2026-05">
                                                <span class="wd-sales-month">May</span>
                                                <span class="wd-sales-amount">-</span>
                                            </div>
                                            <div class="wd-sales-cell wd-sales-cell-empty" data-month="2026-06">
                                                <span class="wd-sales-month">Jun</span>
                                                <span class="wd-sales-amount">-</span>
                                            </div>
                                            <!-- Q3 -->
                                            <div class="wd-sales-cell wd-sales-cell-empty" data-month="2026-07">
                                                <span class="wd-sales-month">Jul</span>
                                                <span class="wd-sales-amount">-</span>
                                            </div>
                                            <div class="wd-sales-cell wd-sales-cell-empty" data-month="2026-08">
                                                <span class="wd-sales-month">Aug</span>
                                                <span class="wd-sales-amount">-</span>
                                            </div>
                                            <div class="wd-sales-cell wd-sales-cell-empty" data-month="2026-09">
                                                <span class="wd-sales-month">Sep</span>
                                                <span class="wd-sales-amount">-</span>
                                            </div>
                                            <!-- Q4 -->
                                            <div class="wd-sales-cell wd-sales-cell-empty" data-month="2026-10">
                                                <span class="wd-sales-month">Oct</span>
                                                <span class="wd-sales-amount">-</span>
                                            </div>
                                            <div class="wd-sales-cell wd-sales-cell-empty" data-month="2026-11">
                                                <span class="wd-sales-month">Nov</span>
                                                <span class="wd-sales-amount">-</span>
                                            </div>
                                            <div class="wd-sales-cell wd-sales-cell-empty" data-month="2026-12">
                                                <span class="wd-sales-month">Dec</span>
                                                <span class="wd-sales-amount">-</span>
                                            </div>
                                        </div>

                                        <!-- Year Total -->
                                        <div class="wd-sales-year-total">
                                            <span class="wd-year-total-label">2024 Total (Completed)</span>
                                            <span class="wd-year-total-amount">$45,600</span>
                                        </div>
                                    </div>

                                    <!-- Recent Completed PI List -->
                                    <div class="wd-drawer-section">
                                        <h4 class="wd-drawer-section-title">Recent Completed Invoices</h4>
                                        <div class="wd-inv-history" id="account-inv-history">
                                            <div class="wd-inv-history-item wd-inv-expandable" onclick="toggleINVProducts(this)">
                                                <div class="wd-inv-history-main">
                                                    <div class="wd-inv-history-info">
                                                        <span class="wd-inv-number">INV-2024-0086</span>
                                                        <span class="wd-inv-date">Jan 20, 2024</span>
                                                    </div>
                                                    <span class="wd-inv-amount">$5,420</span>
                                                    <svg class="wd-inv-expand-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                                                </div>
                                                <div class="wd-inv-products-detail" style="display: none;">
                                                    <div class="wd-inv-product-row">
                                                        <span class="wd-inv-product-name">Extra Virgin Olive Oil 500ml</span>
                                                        <span class="wd-inv-product-qty">80 pcs</span>
                                                        <span class="wd-inv-product-amount">$2,000</span>
                                                    </div>
                                                    <div class="wd-inv-product-row">
                                                        <span class="wd-inv-product-name">Aged Parmesan 24 months</span>
                                                        <span class="wd-inv-product-qty">30 pcs</span>
                                                        <span class="wd-inv-product-amount">$1,950</span>
                                                    </div>
                                                    <div class="wd-inv-product-row">
                                                        <span class="wd-inv-product-name">Organic Honey 350g</span>
                                                        <span class="wd-inv-product-qty">50 pcs</span>
                                                        <span class="wd-inv-product-amount">$900</span>
                                                    </div>
                                                    <div class="wd-inv-product-row">
                                                        <span class="wd-inv-product-name">Balsamic Vinegar 250ml</span>
                                                        <span class="wd-inv-product-qty">18 pcs</span>
                                                        <span class="wd-inv-product-amount">$570</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="wd-inv-history-item wd-inv-expandable" onclick="toggleINVProducts(this)">
                                                <div class="wd-inv-history-main">
                                                    <div class="wd-inv-history-info">
                                                        <span class="wd-inv-number">INV-2024-0078</span>
                                                        <span class="wd-inv-date">Jan 08, 2024</span>
                                                    </div>
                                                    <span class="wd-inv-amount">$4,280</span>
                                                    <svg class="wd-inv-expand-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                                                </div>
                                                <div class="wd-inv-products-detail" style="display: none;">
                                                    <div class="wd-inv-product-row">
                                                        <span class="wd-inv-product-name">Extra Virgin Olive Oil 500ml</span>
                                                        <span class="wd-inv-product-qty">60 pcs</span>
                                                        <span class="wd-inv-product-amount">$1,500</span>
                                                    </div>
                                                    <div class="wd-inv-product-row">
                                                        <span class="wd-inv-product-name">Truffle Oil 100ml</span>
                                                        <span class="wd-inv-product-qty">40 pcs</span>
                                                        <span class="wd-inv-product-amount">$1,800</span>
                                                    </div>
                                                    <div class="wd-inv-product-row">
                                                        <span class="wd-inv-product-name">Dried Pasta 500g</span>
                                                        <span class="wd-inv-product-qty">80 boxes</span>
                                                        <span class="wd-inv-product-amount">$980</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="wd-inv-history-item wd-inv-expandable" onclick="toggleINVProducts(this)">
                                                <div class="wd-inv-history-main">
                                                    <div class="wd-inv-history-info">
                                                        <span class="wd-inv-number">INV-2023-0412</span>
                                                        <span class="wd-inv-date">Dec 15, 2023</span>
                                                    </div>
                                                    <span class="wd-inv-amount">$8,000</span>
                                                    <svg class="wd-inv-expand-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                                                </div>
                                                <div class="wd-inv-products-detail" style="display: none;">
                                                    <div class="wd-inv-product-row">
                                                        <span class="wd-inv-product-name">Aged Parmesan 24 months</span>
                                                        <span class="wd-inv-product-qty">60 pcs</span>
                                                        <span class="wd-inv-product-amount">$3,900</span>
                                                    </div>
                                                    <div class="wd-inv-product-row">
                                                        <span class="wd-inv-product-name">Extra Virgin Olive Oil 500ml</span>
                                                        <span class="wd-inv-product-qty">100 pcs</span>
                                                        <span class="wd-inv-product-amount">$2,500</span>
                                                    </div>
                                                    <div class="wd-inv-product-row">
                                                        <span class="wd-inv-product-name">Organic Honey 350g</span>
                                                        <span class="wd-inv-product-qty">90 pcs</span>
                                                        <span class="wd-inv-product-amount">$1,600</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="wd-drawer-footer">
                                    <button class="wd-btn wd-btn-outline" onclick="editAccount(currentAccountId)">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                                        Edit Account
                                    </button>
                                    <button class="wd-btn wd-btn-primary" onclick="createINVForAccount(currentAccountId)">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="12" y1="18" x2="12" y2="12"/><line x1="9" y1="15" x2="15" y2="15"/></svg>
                                        Add INV
                                    </button>
                                </div>

                                <!-- Product Tooltip (appears on hover) -->
                                <div class="wd-product-tooltip" id="product-tooltip" style="display: none;">
                                    <div class="wd-tooltip-header">
                                        <span class="wd-tooltip-month">January 2024</span>
                                        <span class="wd-tooltip-total">$9,700</span>
                                    </div>
                                    <div class="wd-tooltip-body" id="tooltip-products">
                                        <!-- Products will be populated dynamically -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Account Add/Edit Modal -->
                        <div class="wd-modal-overlay" id="account-modal" style="display: none;">
                            <div class="wd-modal wd-modal-lg">
                                <div class="wd-modal-header">
                                    <h3 class="wd-modal-title" id="account-modal-title" data-i18n="accounts.addAccount">Add Account</h3>
                                    <button class="wd-modal-close" onclick="closeAccountModal()">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                                    </button>
                                </div>
                                <div class="wd-modal-body">
                                    <form id="account-form">
                                        <!-- Company Information -->
                                        <div class="wd-form-section">
                                            <h4 class="wd-form-section-title" data-i18n="accounts.companyInfo">Company Information</h4>
                                            <div class="wd-form-row">
                                                <div class="wd-form-group wd-flex-2">
                                                    <label class="wd-form-label" data-i18n="accounts.companyName">Company Name *</label>
                                                    <input type="text" class="wd-input" id="account-company-name" required placeholder="e.g. ABC Distribution Co.">
                                                </div>
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="accounts.country">Country *</label>
                                                    <select class="wd-select" id="account-country" required>
                                                        <option value="">Select country...</option>
                                                        <option value="KR">ðŸ‡°ðŸ‡· South Korea</option>
                                                        <option value="JP">ðŸ‡¯ðŸ‡µ Japan</option>
                                                        <option value="US">ðŸ‡ºðŸ‡¸ United States</option>
                                                        <option value="CN">ðŸ‡¨ðŸ‡³ China</option>
                                                        <option value="DE">ðŸ‡©ðŸ‡ª Germany</option>
                                                        <option value="GB">ðŸ‡¬ðŸ‡§ United Kingdom</option>
                                                        <option value="FR">ðŸ‡«ðŸ‡· France</option>
                                                        <option value="IT">ðŸ‡®ðŸ‡¹ Italy</option>
                                                        <option value="OTHER">Other</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="wd-form-group">
                                                <label class="wd-form-label" data-i18n="accounts.address">Address</label>
                                                <textarea class="wd-textarea" id="account-address" rows="2" placeholder="Full company address..."></textarea>
                                            </div>
                                        </div>

                                        <!-- Contact Information -->
                                        <div class="wd-form-section">
                                            <h4 class="wd-form-section-title" data-i18n="accounts.contactInfo">Contact Information</h4>
                                            <div class="wd-form-row">
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="accounts.contactPerson">Contact Person *</label>
                                                    <input type="text" class="wd-input" id="account-contact-name" required placeholder="e.g. John Smith">
                                                </div>
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="accounts.position">Position</label>
                                                    <input type="text" class="wd-input" id="account-contact-position" placeholder="e.g. Purchasing Manager">
                                                </div>
                                            </div>
                                            <div class="wd-form-row">
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="accounts.email">Email *</label>
                                                    <input type="email" class="wd-input" id="account-email" required placeholder="e.g. contact@company.com">
                                                </div>
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="accounts.phone">Phone</label>
                                                    <input type="tel" class="wd-input" id="account-phone" placeholder="e.g. +1 234 567 8900">
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Trade Terms -->
                                        <div class="wd-form-section">
                                            <h4 class="wd-form-section-title" data-i18n="accounts.defaultTradeTerms">Default Trade Terms</h4>
                                            <div class="wd-form-row">
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="accounts.currency">Currency</label>
                                                    <select class="wd-select" id="account-currency">
                                                        <option value="USD">USD - US Dollar</option>
                                                        <option value="EUR">EUR - Euro</option>
                                                        <option value="KRW">KRW - Korean Won</option>
                                                        <option value="JPY">JPY - Japanese Yen</option>
                                                    </select>
                                                </div>
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="accounts.incoterms">Default Incoterms</label>
                                                    <select class="wd-select" id="account-incoterms">
                                                        <option value="FOB">FOB - Free on Board</option>
                                                        <option value="CIF">CIF - Cost, Insurance, Freight</option>
                                                        <option value="EXW">EXW - Ex Works</option>
                                                        <option value="DDP">DDP - Delivered Duty Paid</option>
                                                    </select>
                                                </div>
                                                <div class="wd-form-group">
                                                    <label class="wd-form-label" data-i18n="accounts.paymentTerms">Payment Terms</label>
                                                    <select class="wd-select" id="account-payment-terms">
                                                        <option value="tt30">T/T 30% Advance, 70% Before Shipment</option>
                                                        <option value="tt50">T/T 50% Advance, 50% Before Shipment</option>
                                                        <option value="tt100">T/T 100% Advance</option>
                                                        <option value="lc">L/C at Sight</option>
                                                        <option value="dp">D/P at Sight</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Notes -->
                                        <div class="wd-form-section">
                                            <h4 class="wd-form-section-title" data-i18n="accounts.notes">Notes</h4>
                                            <div class="wd-form-group">
                                                <textarea class="wd-textarea" id="account-notes" rows="3" placeholder="Additional notes about this account..."></textarea>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="wd-modal-footer">
                                    <button class="wd-btn wd-btn-outline" onclick="closeAccountModal()" data-i18n="common.cancel">Cancel</button>
                                    <button class="wd-btn wd-btn-primary" onclick="saveAccount()" data-i18n="accounts.saveAccount">Save Account</button>
                                </div>
                            </div>
                        </div>

                        <!-- Buyer Discovery -->
                        <div class="dashboard-panel" id="panel-buyer-discovery">
                            <!-- Page Header -->
                            <div class="wd-page-header">
                                <div class="wd-page-header-content">
                                    <h2 class="wd-page-title" data-i18n="buyerDiscovery.title">Buyer Discovery</h2>
                                    <p class="wd-page-subtitle" data-i18n="buyerDiscovery.subtitle">Find potential buyers interested in your products</p>
                                </div>
                            </div>

                            <!-- Tabs -->
                            <div class="wd-tabs wd-px-6">
                                <button class="wd-tab active" onclick="switchBuyerTab('inquired')" id="tab-inquired" data-i18n="buyerDiscovery.inquiredBuyers">Inquired Buyers</button>
                                <button class="wd-tab" onclick="switchBuyerTab('potential')" id="tab-potential">
                                    <span data-i18n="buyerDiscovery.potentialBuyers">Potential Buyers</span>
                                    <span class="wd-badge wd-badge-premium" style="margin-left: 6px;">Premium</span>
                                </button>
                            </div>

                            <!-- Inquired Buyers (Free) -->
                            <div id="buyer-tab-inquired" style="padding: 24px;">
                                <p class="wd-section-desc" data-i18n="buyerDiscovery.inquiredDesc">Buyers who have directly contacted you with inquiries.</p>

                                <div class="wd-buyer-discovery-list" id="inquired-buyers-list">
                                    <p style="color: var(--wd-gray-400); text-align: center; padding: 40px 0;">Loading...</p>
                                </div>
                            </div>

                            <!-- Potential Buyers (Premium - Blurred) -->
                            <div id="buyer-tab-potential" style="padding: 24px; display: none;">
                                <p class="wd-section-desc" data-i18n="buyerDiscovery.potentialDesc">Buyers searching for products in your categories.</p>

                                <!-- Premium CTA Banner -->
                                <div class="wd-premium-banner">
                                    <div class="wd-premium-content">
                                        <div class="wd-premium-icon">
                                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
                                        </div>
                                        <div class="wd-premium-text">
                                            <h4 data-i18n="buyerDiscovery.unlockTitle">Unlock Potential Buyers</h4>
                                            <p data-i18n="buyerDiscovery.unlockDesc">Subscribe to see buyers actively searching for products like yours</p>
                                        </div>
                                        <button class="wd-btn wd-btn-primary" onclick="showSubscriptionModal()">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
                                            <span data-i18n="buyerDiscovery.subscribe">Subscribe Now</span>
                                        </button>
                                    </div>
                                </div>

                                <!-- Blurred Buyer List (Preview) -->
                                <div class="wd-buyer-discovery-list wd-blurred-section">
                                    <div class="wd-discovery-card wd-blurred">
                                        <div class="wd-discovery-header">
                                            <div class="wd-discovery-company">
                                                <h4 class="wd-discovery-name">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ Trading Co.</h4>
                                                <span class="wd-discovery-country">Germany</span>
                                            </div>
                                        </div>
                                        <div class="wd-discovery-body">
                                            <div class="wd-discovery-info-grid">
                                                <div class="wd-discovery-info">
                                                    <span class="wd-discovery-label">Searched For</span>
                                                    <span class="wd-discovery-value">olive oil, organic</span>
                                                </div>
                                                <div class="wd-discovery-info">
                                                    <span class="wd-discovery-label">Company Size</span>
                                                    <span class="wd-discovery-value">50-100 employees</span>
                                                </div>
                                                <div class="wd-discovery-info">
                                                    <span class="wd-discovery-label">Search Count</span>
                                                    <span class="wd-discovery-value">12 times this month</span>
                                                </div>
                                                <div class="wd-discovery-info">
                                                    <span class="wd-discovery-label">Last Active</span>
                                                    <span class="wd-discovery-value">3 hours ago</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="wd-discovery-card wd-blurred">
                                        <div class="wd-discovery-header">
                                            <div class="wd-discovery-company">
                                                <h4 class="wd-discovery-name">â–ˆâ–ˆâ–ˆâ–ˆ Foods Inc.</h4>
                                                <span class="wd-discovery-country">United States</span>
                                            </div>
                                        </div>
                                        <div class="wd-discovery-body">
                                            <div class="wd-discovery-info-grid">
                                                <div class="wd-discovery-info">
                                                    <span class="wd-discovery-label">Searched For</span>
                                                    <span class="wd-discovery-value">parmesan, cheese</span>
                                                </div>
                                                <div class="wd-discovery-info">
                                                    <span class="wd-discovery-label">Company Size</span>
                                                    <span class="wd-discovery-value">100-500 employees</span>
                                                </div>
                                                <div class="wd-discovery-info">
                                                    <span class="wd-discovery-label">Search Count</span>
                                                    <span class="wd-discovery-value">8 times this month</span>
                                                </div>
                                                <div class="wd-discovery-info">
                                                    <span class="wd-discovery-label">Last Active</span>
                                                    <span class="wd-discovery-value">1 day ago</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="wd-discovery-card wd-blurred">
                                        <div class="wd-discovery-header">
                                            <div class="wd-discovery-company">
                                                <h4 class="wd-discovery-name">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ Import</h4>
                                                <span class="wd-discovery-country">France</span>
                                            </div>
                                        </div>
                                        <div class="wd-discovery-body">
                                            <div class="wd-discovery-info-grid">
                                                <div class="wd-discovery-info">
                                                    <span class="wd-discovery-label">Searched For</span>
                                                    <span class="wd-discovery-value">honey, organic</span>
                                                </div>
                                                <div class="wd-discovery-info">
                                                    <span class="wd-discovery-label">Company Size</span>
                                                    <span class="wd-discovery-value">10-50 employees</span>
                                                </div>
                                                <div class="wd-discovery-info">
                                                    <span class="wd-discovery-label">Search Count</span>
                                                    <span class="wd-discovery-value">5 times this month</span>
                                                </div>
                                                <div class="wd-discovery-info">
                                                    <span class="wd-discovery-label">Last Active</span>
                                                    <span class="wd-discovery-value">2 days ago</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="wd-blurred-overlay">
                                        <div class="wd-blurred-message">
                                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
                                            <h4>23 potential buyers found</h4>
                                            <p>Subscribe to unlock contact information</p>
                                            <button class="wd-btn wd-btn-primary" onclick="showSubscriptionModal()">Unlock for $29/month</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Inquiries -->
                        <div class="dashboard-panel" id="panel-inquiries">
                            <!-- Page Header -->
                            <div class="wd-page-header">
                                <h2 class="wd-page-title" data-i18n="inquiry.title">Inquiries</h2>
                            </div>

                            <!-- Tabs -->
                            <div class="wd-tabs wd-px-6">
                                <button class="wd-tab active" data-i18n="inquiry.allInquiries">All Inquiries</button>
                                <button class="wd-tab" data-i18n="inquiry.quotationRequest">Quotation Request</button>
                                <button class="wd-tab" data-i18n="inquiry.sampleRequest">Sample Request</button>
                            </div>

                            <!-- Inquiry List -->
                            <div style="padding: 24px;">
                                <div class="wd-inquiry-list" id="inquiry-list">
                                    <!-- Data loaded dynamically via API -->
                                </div>
                            </div>
                        </div>

                        <!-- Company Profile -->
                        <div class="dashboard-panel" id="panel-profile">
                            <!-- Page Header -->
                            <div class="wd-page-header">
                                <h2 class="wd-page-title" data-i18n="profile.title">Company Profile</h2>
                                <button class="wd-btn wd-btn-primary" onclick="saveProfile(event)">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>
                                    <span data-i18n="profile.saveChanges">Save Changes</span>
                                </button>
                            </div>

                            <form class="wd-form wd-page-content" id="profile-form" onsubmit="saveProfile(event)">
                                <!-- Company Logo Section -->
                                <div class="wd-card">
                                    <div class="wd-card-header">
                                        <h3 class="wd-card-title" data-i18n="profile.companyLogo">Company Logo</h3>
                                    </div>
                                    <div class="wd-card-body">
                                        <div class="wd-logo-upload">
                                            <div class="wd-logo-preview" id="logo-preview">
                                                <img src="" alt="Company Logo" id="logo-preview-img" style="display: none;">
                                                <div class="wd-logo-placeholder" id="logo-placeholder">
                                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                                        <circle cx="8.5" cy="8.5" r="1.5"/>
                                                        <polyline points="21 15 16 10 5 21"/>
                                                    </svg>
                                                    <span data-i18n="profile.noLogo">No Logo</span>
                                                </div>
                                            </div>
                                            <div class="wd-logo-actions">
                                                <input type="file" id="logo-input" accept="image/*" style="display: none;" onchange="handleLogoSelect(event)">
                                                <button type="button" class="wd-btn wd-btn-outline" onclick="document.getElementById('logo-input').click()">
                                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                                        <polyline points="17 8 12 3 7 8"/>
                                                        <line x1="12" y1="3" x2="12" y2="15"/>
                                                    </svg>
                                                    <span data-i18n="profile.uploadLogo">Upload Logo</span>
                                                </button>
                                                <button type="button" class="wd-btn wd-btn-danger" id="remove-logo-btn" style="display: none;" onclick="removeLogo()">
                                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                        <polyline points="3 6 5 6 21 6"/>
                                                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                                                    </svg>
                                                    <span data-i18n="profile.removeLogo">Remove</span>
                                                </button>
                                                <p class="wd-form-hint" data-i18n="profile.logoHint">Recommended: 200x200px, PNG or JPG, Max 2MB</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Basic Info Section -->
                                <div class="wd-card">
                                    <div class="wd-card-header">
                                        <h3 class="wd-card-title" data-i18n="profile.basicInfo">Basic Information</h3>
                                    </div>
                                    <div class="wd-card-body">
                                        <div class="wd-form-row">
                                            <div class="wd-form-group">
                                                <label class="wd-form-label"><span data-i18n="auth.companyName">Company Name</span> *</label>
                                                <input type="text" class="wd-input" value="Oleificio Ferrara S.r.l." required>
                                            </div>
                                            <div class="wd-form-group">
                                                <label class="wd-form-label"><span data-i18n="auth.country">Country</span> *</label>
                                                <select class="wd-select" required>
                                                    <option value="IT" selected data-i18n="countries.IT">Italy</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="wd-form-row">
                                            <div class="wd-form-group">
                                                <label class="wd-form-label"><span data-i18n="auth.businessEmail">Business Email</span> *</label>
                                                <input type="email" class="wd-input wd-input-readonly" value="sales@oleificio-ferrara.it" readonly title="Email cannot be changed">
                                            </div>
                                            <div class="wd-form-group">
                                                <label class="wd-form-label" data-i18n="profile.phone">Phone</label>
                                                <input type="tel" class="wd-input" value="+39 0123 456789">
                                            </div>
                                        </div>
                                        <div class="wd-form-group">
                                            <label class="wd-form-label" data-i18n="profile.website">Website</label>
                                            <input type="url" class="wd-input" value="https://www.oleificio-ferrara.it">
                                        </div>
                                    </div>
                                </div>

                                <!-- Company Details Section -->
                                <div class="wd-card">
                                    <div class="wd-card-header">
                                        <h3 class="wd-card-title" data-i18n="profile.companyDetails">Company Details</h3>
                                    </div>
                                    <div class="wd-card-body">
                                        <div class="wd-form-row">
                                            <div class="wd-form-group">
                                                <label class="wd-form-label" data-i18n="profile.yearEstablished">Year Established</label>
                                                <input type="number" class="wd-input" value="1985" min="1800" max="2025">
                                            </div>
                                            <div class="wd-form-group">
                                                <label class="wd-form-label" data-i18n="profile.employees">Number of Employees</label>
                                                <select class="wd-select">
                                                    <option value="1-10">1-10</option>
                                                    <option value="11-50" selected>11-50</option>
                                                    <option value="51-200">51-200</option>
                                                    <option value="201-500">201-500</option>
                                                    <option value="500+">500+</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="wd-form-group">
                                            <label class="wd-form-label" data-i18n="profile.description">Company Description</label>
                                            <textarea class="wd-input wd-textarea" rows="4" data-i18n-placeholder="profile.descPlaceholder">Family-owned olive oil producer since 1985, specializing in premium extra virgin olive oil from Puglia region. Our products are certified organic and HACCP compliant.</textarea>
                                        </div>
                                    </div>
                                </div>

                                <!-- Company Certifications Section -->
                                <div class="wd-card">
                                    <div class="wd-card-header" style="display:flex; justify-content:space-between; align-items:center;">
                                        <h3 class="wd-card-title" data-i18n="profile.companyCertifications">Company Certifications</h3>
                                        <a href="cert-edit.html?id=new" class="wd-btn wd-btn-primary wd-btn-sm" style="text-decoration:none;">
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                                            Add Certification
                                        </a>
                                    </div>
                                    <div class="wd-card-body">
                                        <p class="wd-form-hint wd-mb-4" data-i18n="profile.companyCertsDesc">Certifications that apply to your entire company (HACCP, ISO, BRC, etc.). Product-specific certifications can be added when editing each product.</p>
                                        <div class="wd-table-container">
                                            <table class="wd-table">
                                                <thead>
                                                    <tr>
                                                        <th>Name</th>
                                                        <th>Issuer</th>
                                                        <th>Issue Date</th>
                                                        <th>Expiry Date</th>
                                                        <th>Status</th>
                                                        <th style="width:80px;">Actions</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="company-certs-table-body">
                                                    <tr><td colspan="6" style="text-align:center; padding:40px; color:#999;">Loading certifications...</td></tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>

                                <!-- Trade Terms Section -->
                                <div class="wd-card">
                                    <div class="wd-card-header">
                                        <h3 class="wd-card-title" data-i18n="profile.tradeTerms">Trade Terms</h3>
                                    </div>
                                    <div class="wd-card-body">
                                        <div class="wd-form-row">
                                            <div class="wd-form-group">
                                                <label class="wd-form-label" data-i18n="profile.minOrderValue">Minimum Order Value</label>
                                                <div class="wd-input-group">
                                                    <span class="wd-input-prefix">$</span>
                                                    <input type="number" class="wd-input" value="1000" min="0">
                                                </div>
                                            </div>
                                            <div class="wd-form-group">
                                                <label class="wd-form-label" data-i18n="profile.leadTime">Lead Time (days)</label>
                                                <input type="number" class="wd-input" value="14" min="1">
                                            </div>
                                        </div>
                                        <div class="wd-form-group">
                                            <label class="wd-form-label" data-i18n="profile.paymentTerms">Payment Terms</label>
                                            <div class="wd-checkbox-inline">
                                                <label class="wd-checkbox"><input type="checkbox" checked> T/T</label>
                                                <label class="wd-checkbox"><input type="checkbox" checked> L/C</label>
                                                <label class="wd-checkbox"><input type="checkbox"> PayPal</label>
                                                <label class="wd-checkbox"><input type="checkbox"> Western Union</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <!-- Settings -->
                        <div class="dashboard-panel" id="panel-settings">
                            <div class="wd-page-header">
                                <div class="wd-page-header-content">
                                    <h2 class="wd-page-title" data-i18n="settings.title">Settings</h2>
                                    <p class="wd-page-subtitle" data-i18n="settings.subtitle">Manage your account, team, and subscription</p>
                                </div>
                            </div>

                            <!-- Settings Tabs -->
                            <div class="wd-tabs wd-px-6">
                                <button class="wd-tab active" onclick="switchSettingsTab('subscription')" data-i18n="settings.subscriptionTab">Subscription</button>
                                <button class="wd-tab" onclick="switchSettingsTab('team')" data-i18n="settings.teamTab">Team</button>
                                <button class="wd-tab" onclick="switchSettingsTab('logs')" data-i18n="settings.logsTab">Activity Log</button>
                            </div>

                            <!-- Team Tab Panel -->
                            <div class="wd-tab-panel" id="settings-team-panel">
                                <!-- Team Management Section -->
                                <div class="wd-card">
                                    <div class="wd-card-header" style="display: flex; justify-content: space-between; align-items: center;">
                                        <div class="wd-flex wd-items-center wd-gap-3">
                                            <h3 class="wd-card-title" data-i18n="settings.teamManagement">Team Management</h3>
                                            <span class="wd-badge wd-badge-outline" id="team-member-count">3 / 3 members</span>
                                        </div>
                                        <button class="wd-btn wd-btn-primary wd-btn-sm" onclick="openInviteMemberModal()">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                                            <span data-i18n="settings.inviteMember">Invite Member</span>
                                        </button>
                                    </div>
                                    <div class="wd-card-body">
                                        <p class="wd-text-muted wd-mb-4">Manage team members who can access this supplier portal. <span id="team-limit-note" style="color: var(--wd-warning-dark);">Free plan: up to 3 members.</span></p>

                                        <!-- Team Members Table -->
                                        <div class="wd-table-container">
                                            <table class="wd-table">
                                                <thead>
                                                    <tr>
                                                        <th data-i18n="settings.member">Member</th>
                                                        <th data-i18n="settings.role">Role</th>
                                                        <th data-i18n="settings.status">Status</th>
                                                        <th data-i18n="settings.lastActive">Last Active</th>
                                                        <th data-i18n="common.actions">Actions</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="team-members-tbody">
                                                    <tr>
                                                        <td>
                                                            <div class="wd-member-cell">
                                                                <div class="wd-member-avatar">JL</div>
                                                                <div class="wd-member-info">
                                                                    <span class="wd-member-name">Jungwon Lee</span>
                                                                    <span class="wd-member-email">jungwon.lee@seller-note.com</span>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td><span class="wd-badge wd-badge-primary">Owner</span></td>
                                                        <td><span class="wd-badge wd-badge-success">Active</span></td>
                                                        <td>Just now</td>
                                                        <td>-</td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <div class="wd-member-cell">
                                                                <div class="wd-member-avatar">MK</div>
                                                                <div class="wd-member-info">
                                                                    <span class="wd-member-name">Minjun Kim</span>
                                                                    <span class="wd-member-email">minjun@seller-note.com</span>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td><span class="wd-badge wd-badge-secondary">Admin</span></td>
                                                        <td><span class="wd-badge wd-badge-success">Active</span></td>
                                                        <td>2 hours ago</td>
                                                        <td>
                                                            <div class="wd-action-btns">
                                                                <button class="wd-btn-icon" onclick="editMember('MK')" title="Edit">
                                                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                                                                </button>
                                                                <button class="wd-btn-icon wd-btn-icon-danger" onclick="removeMember('MK')" title="Remove">
                                                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
                                                                </button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <div class="wd-member-cell">
                                                                <div class="wd-member-avatar wd-avatar-pending">SP</div>
                                                                <div class="wd-member-info">
                                                                    <span class="wd-member-name">Sales Person</span>
                                                                    <span class="wd-member-email">sales@seller-note.com</span>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td><span class="wd-badge wd-badge-outline">Member</span></td>
                                                        <td><span class="wd-badge wd-badge-warning">Pending</span></td>
                                                        <td>Invite sent</td>
                                                        <td>
                                                            <div class="wd-action-btns">
                                                                <button class="wd-btn-text wd-btn-sm" onclick="resendInvite('SP')">Resend</button>
                                                                <button class="wd-btn-icon wd-btn-icon-danger" onclick="cancelInvite('SP')" title="Cancel">
                                                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                                                                </button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Subscription Tab Panel -->
                            <div class="wd-tab-panel active" id="settings-subscription-panel">
                                <!-- Subscription Section -->
                                <div class="wd-card">
                                    <div class="wd-card-header">
                                        <h3 class="wd-card-title" data-i18n="settings.subscription">Subscription</h3>
                                    </div>
                                    <div class="wd-card-body">
                                        <!-- Current Plan -->
                                        <div class="wd-subscription-status" style="display: flex; justify-content: space-between; align-items: flex-start; padding: 20px; background: var(--wd-gray-50); border-radius: 12px; margin-bottom: 20px;">
                                            <div>
                                                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                                    <h4 class="wd-m-0" data-i18n="settings.currentPlan">Current Plan</h4>
                                                    <span class="wd-badge wd-badge-success">Free</span>
                                                </div>
                                                <p class="wd-text-muted wd-m-0" data-i18n="settings.freePlanDescription">Basic features with limited buyer discovery</p>
                                            </div>
                                            <button class="wd-btn wd-btn-primary" onclick="showUpgradeModal()">
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
                                                <span data-i18n="settings.upgradeToPremium">Upgrade to Premium</span>
                                            </button>
                                        </div>

                                        <!-- Plan Comparison -->
                                        <div class="wd-plans-comparison" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                                            <!-- Free Plan -->
                                            <div class="wd-plan-card" style="padding: 24px; border: 2px solid var(--wd-gray-200); border-radius: 12px;">
                                                <h4 style="margin: 0 0 4px;">Free</h4>
                                                <p class="wd-text-muted" style="margin: 0 0 16px; font-size: 14px;">For getting started</p>
                                                <div style="font-size: 32px; font-weight: 700; margin-bottom: 16px;">$0 <span style="font-size: 14px; font-weight: 400; color: var(--wd-gray-500);">/month</span></div>
                                                <ul style="list-style: none; padding: 0; margin: 0;">
                                                    <li class="wd-flex wd-items-center wd-gap-2 wd-mb-2">
                                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--wd-success)" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                                                        <span>Unlimited products</span>
                                                    </li>
                                                    <li class="wd-flex wd-items-center wd-gap-2 wd-mb-2">
                                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--wd-success)" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                                                        <span>PO/INV management</span>
                                                    </li>
                                                    <li class="wd-flex wd-items-center wd-gap-2 wd-mb-2">
                                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--wd-success)" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                                                        <span>Inquired buyers only</span>
                                                    </li>
                                                    <li class="wd-flex wd-items-center wd-gap-2 wd-mb-2">
                                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--wd-success)" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                                                        <span>Up to 3 team members</span>
                                                    </li>
                                                </ul>
                                            </div>

                                            <!-- Premium Plan -->
                                            <div class="wd-plan-card wd-plan-recommended" style="padding: 24px; border: 2px solid var(--wd-primary); border-radius: 12px; position: relative;">
                                                <span class="wd-plan-badge" style="position: absolute; top: -12px; right: 20px; background: var(--wd-primary); color: white; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600;">Recommended</span>
                                                <h4 style="margin: 0 0 4px;">Premium</h4>
                                                <p class="wd-text-muted" style="margin: 0 0 16px; font-size: 14px;">For growing businesses</p>
                                                <div style="font-size: 32px; font-weight: 700; margin-bottom: 16px;">$49 <span style="font-size: 14px; font-weight: 400; color: var(--wd-gray-500);">/month</span></div>
                                                <ul style="list-style: none; padding: 0; margin: 0 0 16px;">
                                                    <li class="wd-flex wd-items-center wd-gap-2 wd-mb-2">
                                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--wd-success)" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                                                        <span>Everything in Free</span>
                                                    </li>
                                                    <li class="wd-flex wd-items-center wd-gap-2 wd-mb-2">
                                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--wd-success)" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                                                        <span><strong>Potential buyer discovery</strong></span>
                                                    </li>
                                                    <li class="wd-flex wd-items-center wd-gap-2 wd-mb-2">
                                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--wd-success)" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                                                        <span><strong>Keyword alerts</strong></span>
                                                    </li>
                                                    <li class="wd-flex wd-items-center wd-gap-2 wd-mb-2">
                                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--wd-success)" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                                                        <span>Priority search ranking</span>
                                                    </li>
                                                    <li class="wd-flex wd-items-center wd-gap-2 wd-mb-2">
                                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--wd-success)" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                                                        <span>Unlimited team members</span>
                                                    </li>
                                                </ul>
                                                <button class="wd-btn wd-btn-primary wd-btn-full" onclick="startCheckout('premium')">
                                                    Start Free Trial
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Billing History -->
                                <div class="wd-card">
                                    <div class="wd-card-header">
                                        <h3 class="wd-card-title" data-i18n="settings.billingHistory">Billing History</h3>
                                    </div>
                                    <div class="wd-card-body">
                                        <div class="wd-empty-state" style="text-align: center; padding: 40px;">
                                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="var(--wd-gray-300)" stroke-width="1.5" class="wd-mb-4"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>
                                            <p class="wd-text-muted" data-i18n="settings.noBillingHistory">No billing history yet</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Logs Tab Panel -->
                            <div class="wd-tab-panel" id="settings-logs-panel">
                                <!-- Activity Log -->
                                <div class="wd-card">
                                    <div class="wd-card-header" style="display: flex; justify-content: space-between; align-items: center;">
                                        <h3 class="wd-card-title" data-i18n="settings.activityLog">Activity Log</h3>
                                        <div class="wd-filter-group" style="display: flex; gap: 12px;">
                                            <select class="wd-select wd-select-sm" id="activity-member-filter" onchange="filterActivityLog()">
                                                <option value="all">All Members</option>
                                                <option value="JL">Jungwon Lee</option>
                                                <option value="MK">Minjun Kim</option>
                                            </select>
                                            <select class="wd-select wd-select-sm" id="activity-type-filter" onchange="filterActivityLog()">
                                                <option value="all">All Actions</option>
                                                <option value="product">Product</option>
                                                <option value="po">PO</option>
                                                <option value="inv">INV</option>
                                                <option value="account">Account</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="wd-card-body" style="padding: 0;">
                                        <div class="wd-activity-list" id="activity-log-list">
                                            <!-- Activity Item -->
                                            <div class="wd-activity-item" data-member="JL" data-type="pi">
                                                <div class="wd-activity-avatar">JL</div>
                                                <div class="wd-activity-content">
                                                    <div class="wd-activity-text">
                                                        <strong>Jungwon Lee</strong> created INV <a href="#" onclick="viewPI('INV-2024-0089')">INV-2024-0089</a>
                                                    </div>
                                                    <div class="wd-activity-meta">
                                                        <span class="wd-activity-type">INV</span>
                                                        <span class="wd-activity-time">10 minutes ago</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="wd-activity-item" data-member="MK" data-type="product">
                                                <div class="wd-activity-avatar">MK</div>
                                                <div class="wd-activity-content">
                                                    <div class="wd-activity-text">
                                                        <strong>Minjun Kim</strong> updated product <a href="#" onclick="editProduct('OIL-001')">Extra Virgin Olive Oil</a>
                                                    </div>
                                                    <div class="wd-activity-meta">
                                                        <span class="wd-activity-type">Product</span>
                                                        <span class="wd-activity-time">1 hour ago</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="wd-activity-item" data-member="JL" data-type="po">
                                                <div class="wd-activity-avatar">JL</div>
                                                <div class="wd-activity-content">
                                                    <div class="wd-activity-text">
                                                        <strong>Jungwon Lee</strong> registered PO <a href="#" onclick="viewPODetail('PO-2024-0156')">PO-2024-0156</a>
                                                    </div>
                                                    <div class="wd-activity-meta">
                                                        <span class="wd-activity-type">PO</span>
                                                        <span class="wd-activity-time">2 hours ago</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="wd-activity-item" data-member="MK" data-type="po">
                                                <div class="wd-activity-avatar">MK</div>
                                                <div class="wd-activity-content">
                                                    <div class="wd-activity-text">
                                                        <strong>Minjun Kim</strong> confirmed PO <a href="#" onclick="viewPODetail('PO-2024-0142')">PO-2024-0142</a>
                                                    </div>
                                                    <div class="wd-activity-meta">
                                                        <span class="wd-activity-type">PO</span>
                                                        <span class="wd-activity-time">3 hours ago</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="wd-activity-item" data-member="JL" data-type="account">
                                                <div class="wd-activity-avatar">JL</div>
                                                <div class="wd-activity-content">
                                                    <div class="wd-activity-text">
                                                        <strong>Jungwon Lee</strong> added account <a href="#" onclick="viewAccount('ACC-003')">Global Trade Co</a>
                                                    </div>
                                                    <div class="wd-activity-meta">
                                                        <span class="wd-activity-type">Account</span>
                                                        <span class="wd-activity-time">Yesterday</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="wd-activity-item" data-member="MK" data-type="product">
                                                <div class="wd-activity-avatar">MK</div>
                                                <div class="wd-activity-content">
                                                    <div class="wd-activity-text">
                                                        <strong>Minjun Kim</strong> registered 12 products from catalog
                                                    </div>
                                                    <div class="wd-activity-meta">
                                                        <span class="wd-activity-type">Product</span>
                                                        <span class="wd-activity-time">2 days ago</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="wd-activity-footer" style="padding: 16px; text-align: center; border-top: 1px solid var(--wd-gray-100);">
                                            <button class="wd-btn wd-btn-text" onclick="loadMoreActivities()">Load More</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div><!-- end panel-settings -->
                    </div>
                </div>
            </section>
        </main>

        <!-- Invite Member Modal -->
        <div class="wd-modal-overlay" id="invite-member-modal" style="display: none;">
            <div class="wd-modal wd-modal-sm">
                <div class="wd-modal-header">
                    <h3 class="wd-modal-title" data-i18n="settings.inviteMember">Invite Member</h3>
                    <button class="wd-btn-icon" onclick="closeInviteMemberModal()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                    </button>
                </div>
                <div class="wd-modal-body">
                    <form id="invite-member-form" onsubmit="sendInvite(event)">
                        <div class="wd-form-group">
                            <label class="wd-form-label" data-i18n="settings.emailAddress">Email Address</label>
                            <input type="email" class="wd-input" id="invite-email" placeholder="colleague@company.com" required>
                        </div>
                        <div class="wd-form-group">
                            <label class="wd-form-label" data-i18n="settings.role">Role</label>
                            <select class="wd-select" id="invite-role">
                                <option value="admin">Admin - Full access</option>
                                <option value="member" selected>Member - View & edit</option>
                                <option value="viewer">Viewer - View only</option>
                            </select>
                        </div>
                        <div class="wd-form-group">
                            <label class="wd-form-label" data-i18n="settings.personalMessage">Personal Message (Optional)</label>
                            <textarea class="wd-textarea" id="invite-message" rows="3" placeholder="Add a personal message to the invitation..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="wd-modal-footer">
                    <button type="button" class="wd-btn wd-btn-outline" onclick="closeInviteMemberModal()" data-i18n="common.cancel">Cancel</button>
                    <button type="submit" class="wd-btn wd-btn-primary" onclick="sendInvite(event)">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
                        <span data-i18n="settings.sendInvite">Send Invite</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Product Add/Edit Modal -->
        <div class="wd-modal-overlay" id="product-modal" style="display: none;">
            <div class="wd-modal wd-modal-lg">
                <div class="wd-modal-header">
                    <h3 class="wd-modal-title" id="product-modal-title">Add Product</h3>
                    <button class="wd-modal-close" onclick="closeProductModal()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                    </button>
                </div>
                <div class="wd-modal-body">
                    <form id="product-edit-form">
                        <!-- Basic Information -->
                        <div class="wd-form-section">
                            <h4 class="wd-form-section-title">Basic Information</h4>
                            <div class="wd-form-row">
                                <div class="wd-form-group wd-flex-2">
                                    <label class="wd-form-label">Product Name *</label>
                                    <input type="text" class="wd-input" id="edit-product-name" required placeholder="e.g. Extra Virgin Olive Oil 500ml">
                                </div>
                                <div class="wd-form-group">
                                    <label class="wd-form-label">SKU</label>
                                    <input type="text" class="wd-input" id="edit-product-sku" placeholder="e.g. OIL-001">
                                </div>
                            </div>
                            <div class="wd-form-row">
                                <div class="wd-form-group">
                                    <label class="wd-form-label">Category</label>
                                    <select class="wd-select" id="edit-product-category">
                                        <option value="">Select category...</option>
                                        <optgroup label="Oils & Fats">
                                            <option value="evoo">Extra Virgin Olive Oil</option>
                                            <option value="olive-oil">Olive Oil</option>
                                            <option value="seed-oils">Seed Oils</option>
                                            <option value="nut-oils">Nut Oils</option>
                                            <option value="truffle-oil">Truffle Oil</option>
                                        </optgroup>
                                        <optgroup label="Vinegars & Condiments">
                                            <option value="balsamic">Balsamic Vinegar</option>
                                            <option value="wine-vinegar">Wine Vinegar</option>
                                            <option value="sauces">Sauces & Pesto</option>
                                            <option value="mustard-dressings">Mustard & Dressings</option>
                                        </optgroup>
                                        <optgroup label="Dairy & Cheese">
                                            <option value="hard-cheese">Hard Cheese</option>
                                            <option value="soft-cheese">Soft Cheese</option>
                                            <option value="aged-cheese">Aged Cheese</option>
                                            <option value="butter-cream">Butter & Cream</option>
                                        </optgroup>
                                        <optgroup label="Meat & Charcuterie">
                                            <option value="cured-meats">Cured Meats</option>
                                            <option value="sausages">Sausages</option>
                                            <option value="smoked-meats">Smoked Meats</option>
                                        </optgroup>
                                        <optgroup label="Pasta & Grains">
                                            <option value="dried-pasta">Dried Pasta</option>
                                            <option value="fresh-pasta">Fresh Pasta</option>
                                            <option value="rice">Rice</option>
                                            <option value="flour-semolina">Flour & Semolina</option>
                                        </optgroup>
                                        <optgroup label="Bakery & Confectionery">
                                            <option value="bread">Bread</option>
                                            <option value="biscuits-cookies">Biscuits & Cookies</option>
                                            <option value="chocolate">Chocolate</option>
                                            <option value="pastries">Pastries</option>
                                        </optgroup>
                                        <optgroup label="Canned & Preserved">
                                            <option value="tomato-products">Tomato Products</option>
                                            <option value="pickles-olives">Pickles & Olives</option>
                                            <option value="preserved-veg">Preserved Vegetables</option>
                                            <option value="jams-spreads">Jams & Spreads</option>
                                        </optgroup>
                                        <optgroup label="Beverages">
                                            <option value="wine">Wine</option>
                                            <option value="spirits">Spirits</option>
                                            <option value="coffee">Coffee</option>
                                            <option value="tea">Tea</option>
                                            <option value="juices-soft">Juices & Soft Drinks</option>
                                        </optgroup>
                                        <optgroup label="Seafood">
                                            <option value="fresh-fish">Fresh Fish</option>
                                            <option value="canned-fish">Canned Fish</option>
                                            <option value="shellfish">Shellfish</option>
                                            <option value="smoked-fish">Smoked Fish</option>
                                        </optgroup>
                                        <optgroup label="Spices, Herbs & Sweeteners">
                                            <option value="spice-blends">Spice Blends</option>
                                            <option value="herbs">Herbs</option>
                                            <option value="honey">Honey</option>
                                        </optgroup>
                                        <optgroup label="Snacks & Nuts">
                                            <option value="nuts-dried-fruit">Nuts & Dried Fruit</option>
                                            <option value="chips-crackers">Chips & Crackers</option>
                                            <option value="bars">Snack Bars</option>
                                        </optgroup>
                                        <optgroup label="Specialty & Health">
                                            <option value="organic">Organic</option>
                                            <option value="gluten-free">Gluten-Free</option>
                                            <option value="vegan-plant">Vegan & Plant-Based</option>
                                            <option value="frozen">Frozen Foods</option>
                                        </optgroup>
                                    </select>
                                </div>
                                <div class="wd-form-group">
                                    <label class="wd-form-label">Status</label>
                                    <select class="wd-select" id="edit-product-status">
                                        <option value="active">Active</option>
                                        <option value="completed">Completed</option>
                                        <option value="draft">Draft</option>
                                        <option value="discontinued">Discontinued</option>
                                    </select>
                                </div>
                            </div>
                            <div class="wd-form-group">
                                <label class="wd-form-label">Description</label>
                                <textarea class="wd-textarea" id="edit-product-description" rows="3" placeholder="Product description..."></textarea>
                            </div>
                        </div>

                        <!-- Pricing & MOQ -->
                        <div class="wd-form-section">
                            <h4 class="wd-form-section-title">Pricing & MOQ</h4>
                            <div class="wd-form-row">
                                <div class="wd-form-group">
                                    <label class="wd-form-label">Min Price (FOB USD)</label>
                                    <input type="number" class="wd-input" id="edit-price-min" step="0.01" placeholder="0.00">
                                </div>
                                <div class="wd-form-group">
                                    <label class="wd-form-label">Max Price (FOB USD)</label>
                                    <input type="number" class="wd-input" id="edit-price-max" step="0.01" placeholder="0.00">
                                </div>
                            </div>
                            <div class="wd-form-row">
                                <div class="wd-form-group">
                                    <label class="wd-form-label">MOQ (Minimum Order Quantity)</label>
                                    <input type="number" class="wd-input" id="edit-moq" placeholder="e.g., 100">
                                </div>
                                <div class="wd-form-group">
                                    <label class="wd-form-label">MOQ Unit</label>
                                    <select class="wd-select" id="edit-moq-unit">
                                        <option value="">Select unit...</option>
                                        <option value="pieces">Pieces</option>
                                        <option value="bottles">Bottles</option>
                                        <option value="cases">Cases</option>
                                        <option value="kg">Kg</option>
                                        <option value="tons">Tons</option>
                                        <option value="liters">Liters</option>
                                        <option value="pallets">Pallets</option>
                                        <option value="containers">Containers</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Certifications -->
                        <div class="wd-form-section">
                            <h4 class="wd-form-section-title">Certifications</h4>
                            <div class="wd-checkbox-grid" id="product-cert-grid" style="grid-template-columns: repeat(3, 1fr);">
                                <label class="wd-checkbox-card"><input type="checkbox" value="organic"> <span class="wd-checkbox-label">Organic</span></label>
                                <label class="wd-checkbox-card"><input type="checkbox" value="halal"> <span class="wd-checkbox-label">Halal</span></label>
                                <label class="wd-checkbox-card"><input type="checkbox" value="kosher"> <span class="wd-checkbox-label">Kosher</span></label>
                                <label class="wd-checkbox-card"><input type="checkbox" value="vegan"> <span class="wd-checkbox-label">Vegan</span></label>
                                <label class="wd-checkbox-card"><input type="checkbox" value="non-gmo"> <span class="wd-checkbox-label">Non-GMO</span></label>
                                <label class="wd-checkbox-card"><input type="checkbox" value="dop"> <span class="wd-checkbox-label">DOP/PDO</span></label>
                                <label class="wd-checkbox-card"><input type="checkbox" value="igp"> <span class="wd-checkbox-label">IGP/PGI</span></label>
                                <label class="wd-checkbox-card"><input type="checkbox" value="gluten-free"> <span class="wd-checkbox-label">Gluten-Free</span></label>
                                <label class="wd-checkbox-card"><input type="checkbox" value="fair-trade"> <span class="wd-checkbox-label">Fair Trade</span></label>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="wd-modal-footer">
                    <button class="wd-btn wd-btn-outline" onclick="closeProductModal()">Cancel</button>
                    <button class="wd-btn wd-btn-primary" onclick="saveProduct()">Save Product</button>
                </div>
            </div>
        </div>
    </div>

    <script src="i18n.js"></script>
    <script src="js/sidebar.js?v=1.1"></script>
    <!-- Legacy app.js for backward compatibility -->
    <script src="app.js"></script>
    <!-- Modular JS (ES6 modules) - Uncomment to use -->
    <!-- <script type="module" src="js/app.js"></script> -->
    <script>
        // Initialize language dropdown
        document.addEventListener('DOMContentLoaded', () => {
            initI18n();
            renderLanguageList();
        });

        // Toggle language dropdown
        function toggleLanguageDropdown() {
            const menu = document.getElementById('language-menu');
            const dropdown = document.getElementById('language-dropdown');
            menu.classList.toggle('show');
            dropdown.classList.toggle('active');
        }

        // Close dropdown on outside click
        document.addEventListener('click', (e) => {
            const dropdown = document.getElementById('language-dropdown');
            if (dropdown && !dropdown.contains(e.target)) {
                document.getElementById('language-menu').classList.remove('show');
                dropdown.classList.remove('active');
            }
        });

        // Render language list
        function renderLanguageList(filter = '') {
            const list = document.getElementById('language-list');
            const filterLower = filter.toLowerCase();

            const filtered = supportedLanguages.filter(lang =>
                lang.name.toLowerCase().includes(filterLower) ||
                lang.nativeName.toLowerCase().includes(filterLower) ||
                lang.code.toLowerCase().includes(filterLower)
            );

            list.innerHTML = filtered.map(lang => `
                <div class="language-item ${lang.code === currentLanguage ? 'active' : ''}"
                     onclick="selectLanguage('${lang.code}')">
                    <span class="lang-flag">${lang.flag}</span>
                    <span class="lang-name">${lang.nativeName}</span>
                    <span class="lang-code">${lang.name}</span>
                    ${lang.code === currentLanguage ? '<span class="lang-check">âœ“</span>' : ''}
                </div>
            `).join('');
        }

        // Select language
        function selectLanguage(code) {
            setLanguage(code);
            renderLanguageList();
            document.getElementById('language-menu').classList.remove('show');
            document.getElementById('language-dropdown').classList.remove('active');
        }

        // Filter languages
        function filterLanguages(value) {
            renderLanguageList(value);
        }
    </script>

    <!-- Logo Crop Modal -->
    <div class="wd-modal-overlay" id="crop-modal" style="display: none;">
        <div class="wd-modal" style="max-width: 500px;">
            <div class="wd-modal-header">
                <h3 class="wd-modal-title" data-i18n="profile.cropLogo">Crop Logo</h3>
                <button type="button" class="wd-btn-icon" onclick="closeCropModal()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                </button>
            </div>
            <div class="wd-modal-body">
                <div class="crop-container">
                    <img id="crop-image" src="" alt="Crop preview">
                </div>
            </div>
            <div class="wd-modal-footer">
                <button type="button" class="wd-btn wd-btn-outline" onclick="closeCropModal()" data-i18n="common.cancel">Cancel</button>
                <button type="button" class="wd-btn wd-btn-primary" onclick="applyCrop()" data-i18n="profile.applyCrop">Apply</button>
            </div>
        </div>
    </div>
</body>
</html>
